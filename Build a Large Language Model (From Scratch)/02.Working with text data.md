<!-- language: rtl -->

# ฒ.ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง ูุชู

ุชุง ุงูุฌุง ุจุง ุณุงุฎุชุงุฑ ฺฉู ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM) ุขุดูุง ุดุฏู ู ุฏุงูุณุชู ฺฉู ุงู ูุฏูโูุง ุจุง ุญุฌู ุจุณุงุฑ ุฒุงุฏ ุงุฒ ูุชู ุงุฒ ูพุด ุขููุฒุด ุฏุงุฏู ูโุดููุฏ. ุชูุฑฺฉุฒ ูุง ุจูโูฺู ุจุฑ ูุฏูโูุง **ููุท ุฏฺฉูุฏุฑ (decoder-only)** ูุจุชู ุจุฑ ูุนูุงุฑ **ุชุฑูุณููุฑูุฑ** ุจูุฏุ ูุนูุงุฑโุง ฺฉู ุฏุฑ ูุฏูโูุง ูุงููุฏ **ChatGPT** ู ุณุงุฑ ูุฏูโูุง ูุดุงุจู GPT ุงุณุชูุงุฏู ูโุดูุฏ.

ุฏุฑ ูุฑุญูู ูพุดโุขููุฒุด (pretraining)ุ ูุฏูโูุง ุฒุจุงูุ ูุชู ุฑุง **ฺฉููู ุจู ฺฉููู** ูพุฑุฏุงุฒุด ูโฺฉููุฏ. ุขููุฒุด ุงู ูุฏูโูุง ุจุง ููููโูุง ุง ุญุช ููุงุฑุฏูุง ูพุงุฑุงูุชุฑุ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุธููโุง ุจู ูุงู **ูพุดโุจู ฺฉููู ุจุนุฏ** (next-word prediction)ุ ููุฌุฑ ุจู ุชููุฏ ูุฏูโูุง ุจุง ูุงุจูุชโูุง ฺุดูฺฏุฑ ูโุดูุฏ. ูพุณ ุงุฒ ุขูุ ุงู ูุฏูโูุง ูโุชูุงููุฏ ุจุฑุง ุงูุฌุงู ูุธุงู ุฎุงุต ุง ูพุฑู ุงุฒ ุฏุณุชูุฑุงูุนููโูุง ุนููู **ุชูุธู ุฏูู (fine-tuning)** ุดููุฏ.

ุงูุง ูพุด ุงุฒ ุขูฺฉู ุจุชูุงูู ฺฉ ูุฏู ุฒุจุงู ุจุฒุฑฺฏ ุฑุง ูพุงุฏูโุณุงุฒ ู ุขููุฒุด ุฏููุ ุจุงุฏ **ุฏุงุฏูโูุง ุขููุฒุด ุฑุง ุขูุงุฏู ฺฉูู**ุ ุฑููุฏ ฺฉู ุฏุฑ **ุดฺฉู ฒ.ฑ** ุจู ุชุตูุฑ ฺฉุดุฏู ุดุฏู ุงุณุช. ุงู ูุตู ุจุฑ **ูุฑุญูู ุงูู ุงุฒ ฺฏุงู ุงูู** ุนู **ูพุงุฏูโุณุงุฒ ูพุงูพโูุงู ูููููโุจุฑุฏุงุฑ ุงุฒ ุฏุงุฏูโูุง** ุชูุฑฺฉุฒ ุฏุงุฑุฏ.

ุฏุฑ ุงู ูุตู ุงุฏ ูโฺฏุฑุฏ ฺฉู ฺฺฏููู ูุฑูุฏโูุง ูุชู ุฑุง ุจุฑุง ุขููุฒุด ูุฏูโูุง ุฒุจุงู ุขูุงุฏู ฺฉูุฏ. ุงู ูุฑุขูุฏ ุดุงูู **ุชูุณู ูุชู ุจู ุชูฺฉูโูุง ฺฉูููโุง ุง ุฒุฑฺฉูููโุง** ู ุณูพุณ **ฺฉุฏฺฏุฐุงุฑ ุขูโูุง ุจู ุจุฑุฏุงุฑูุง ุนุฏุฏ** ุงุณุช ฺฉู ูุฏู ูโุชูุงูุฏ ุงุฒ ุขูโูุง ุงุณุชูุงุฏู ฺฉูุฏ. ููฺูู ุจุง **ุฑูุดโูุง ูพุดุฑูุชู ุชูฺฉูโุณุงุฒ** ูุงููุฏ **ุฑูุฒฺฏุฐุงุฑ ุฌูุชโุจุงุช (Byte Pair Encoding)** ุขุดูุง ูโุดูุฏ ฺฉู ุฏุฑ ูุฏูโูุง ูุงููุฏ GPT ฺฉุงุฑุจุฑุฏ ุฏุงุฑูุฏ. ุฏุฑ ููุงุชุ ุฑูุดโูุง ุจุฑุง **ูููููโุจุฑุฏุงุฑ ุงุฒ ุฏุงุฏูโูุง ู ุจุงุฑฺฏุฐุงุฑ ุขูโูุง** ุฌูุช ุชููุฏ ุฌูุชโูุง ูุฑูุฏโุฎุฑูุฌ ุจุฑุง ุขููุฒุด ูุฏู ุงุฑุงุฆู ุฎูุงูุฏ ุดุฏ.

---

## ฒ.ฑ ุฏุฑฺฉ ุจุฑุฏุงุฑูุง ุชุนุจูโุดุฏูโ ูุงฺู (Word Embeddings)

ูุฏูโูุง ุนุตุจ ุนููุ ุงุฒ ุฌููู ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏุ **ูุงุฏุฑ ุจู ูพุฑุฏุงุฒุด ูุณุชูู ูุชู ุฎุงู ูุณุชูุฏ**. ุฏูู ุงู ุงูุฑ ุขู ุงุณุช ฺฉู ูุชูุ **ุฏุงุฏูโุง ุฏุณุชูโุง (categorical)** ุงุณุช ู ุจุง ุนููุงุช ุฑุงุถโุง ฺฉู ุจุฑุง ุขููุฒุด ุดุจฺฉูโูุง ุนุตุจ ูุงุฒู ุงุณุชุ ุณุงุฒฺฏุงุฑ ูุณุช. ุจูุงุจุฑุงูุ ูุงุฒ ุฏุงุฑู ฺฉู ฺฉููุงุช ุฑุง ุจู ุดฺฉู **ุจุฑุฏุงุฑูุง ุจุง ููุงุฏุฑ ูพูุณุชู** ููุงุด ุฏูู.

> **ูฺฉุชู:** ุงฺฏุฑ ุจุง ููุงูู ุจุฑุฏุงุฑ ู ุชูุณูุฑ ุฏุฑ ุฒููู ูุญุงุณุจุงุช ุขุดูุง ูุณุชุฏุ ูโุชูุงูุฏ ุจู **ุถููู Aุ ุจุฎุด A.2.2** ูุฑุงุฌุนู ฺฉูุฏ.

ูุฑุขูุฏ ุชุจุฏู ุฏุงุฏูโูุง ุบุฑุนุฏุฏ ุจู ุจุฑุฏุงุฑูุง ุนุฏุฏุ ูุนูููุงู ุจุง ุนููุงู **ุชุนุจู (Embedding)** ุดูุงุฎุชู ูโุดูุฏ. ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ูุงู ุฎุงุต ุฏุฑ ุดุจฺฉู ุนุตุจ ุง ฺฉ ูุฏู ุงุฒ ูพุด ุขููุฒุดโุฏุฏูุ ูโุชูุงู ุฏุงุฏูโูุง ุงุฒ ุงููุงุน ูุฎุชูู ูุงููุฏ **ูุฏุฆูุ ุตุฏุง ุง ูุชู** ุฑุง ุจู ูุถุง ุจุฑุฏุงุฑ ููุชูู ฺฉุฑุฏ. ุงูุจุชู ุจุงุฏ ุชูุฌู ุฏุงุดุช ฺฉู ูุฑ ููุน ุฏุงุฏู ูุงุฒ ุจู ูุฏู ุชุนุจู ูุฎุตูุต ุจู ุฎูุฏ ุฏุงุฑุฏุ ุจุฑุง ูุซุงูุ ูุฏู ฺฉู ุจุฑุง ุชุนุจู ูุชู ุทุฑุงุญ ุดุฏู ุจุงุดุฏุ ุจุฑุง ุชุนุจู ูุฏุฆู ุง ุตุฏุง ููุงุณุจ ูุณุช.

**ุดฺฉู ฒ.ฒ** ุงู ููุถูุน ุฑุง ุจูโุฎูุจ ูุดุงู ูโุฏูุฏุ ุงูฺฉู ุฏุงุฏูโูุง ุฎุงู ูุงููุฏ ูุชูุ ูุฏุฆู ุง ุตุฏุง ูุณุชููุงู ุจุฑุง ูุฏู ูุงุจู ุงุณุชูุงุฏู ูุณุชูุฏ ู ุจุงุฏ ุงุจุชุฏุง ุจู ุจุฑุฏุงุฑูุง ูุดุฑุฏู ู ุนุฏุฏ ุชุจุฏู ุดููุฏ ุชุง ูุฏู ุจุชูุงูุฏ ุขูโูุง ุฑุง ูพุฑุฏุงุฒุด ฺฉูุฏ.

ุฏุฑ ุงุตูุ ุชุนุจูุ ููุน ูฺฏุงุดุช (mapping) ุงุฒ ุงุดุง ฺฏุณุณุชู โ ูุงููุฏ ฺฉููุงุชุ ุชุตุงูุฑ ุง ุญุช ฺฉู ุงุณูุงุฏ โ ุจู **ููุงุท ุฏุฑ ฺฉ ูุถุง ุจุฑุฏุงุฑ ูพูุณุชู** ุงุณุช. ูุฏู ุงุตู ุงุฒ ุชุนุจู ุงู ุงุณุช ฺฉู ุฏุงุฏูโูุง ุบุฑุนุฏุฏ ุฑุง ุจู ูุฑูุช ูุงุจู ุงุณุชูุงุฏู ุจุฑุง ุดุจฺฉูโูุง ุนุตุจ ุชุจุฏู ฺฉูุฏ.

ฺฏุฑฺู **ุชุนุจู ูุงฺูโุง (word embedding)** ุฑุงุฌโุชุฑู ุดฺฉู ุชุนุจู ุจุฑุง ูุชู ุงุณุชุ ุงูุง ูุณุฎูโูุง ูพุดุฑูุชูโุชุฑ ูุฒ ูุฌูุฏ ุฏุงุฑุฏุ ูุงููุฏ ุชุนุจูโูุง ุฌูููโุง ุง ูพุงุฑุงฺฏุฑุงู. ุงู ููุน ุชุนุจูโูุง ุฏุฑ ุชฺฉูฺฉ ุจู ูุงู **ุชููุฏ ูุจุชู ุจุฑ ุจุงุฒุงุจ (Retrieval-Augmented Generation)** ุจุณุงุฑ ฺฉุงุฑุจุฑุฏ ุฏุงุฑูุฏ. ุฏุฑ ุงู ุฑูุดุ ูุฏู ูู ุนูู ุชููุฏ ูุชู ู ูู ุจุงุฒุงุจ ุงุทูุงุนุงุช ุงุฒ ููุงุจุน ุฎุงุฑุฌ ุฑุง ุงูุฌุงู ูโุฏูุฏ. ุงูุจุชู ุงู ูุจุญุซุ ุฎุงุฑุฌ ุงุฒ ุญุทู ุงู ฺฉุชุงุจ ุงุณุช.

ุงุฒ ุขูุฌุง ฺฉู ูุฏู ูุง **ุขููุฒุด ูุฏูโูุง ูุงููุฏ GPT** ุงุณุช ฺฉู ูุชู ุฑุง **ฺฉููู ุจู ฺฉููู ุชููุฏ ูโฺฉููุฏ**ุ ุชูุฑฺฉุฒ ูุง ุจุฑ ุชุนุจู ูุงฺูโุง ุฎูุงูุฏ ุจูุฏ.

---

ฺูุฏู ุงูฺฏูุฑุชู ู ฺุงุฑฺูุจ ุจุฑุง ุชููุฏ ุชุนุจูโูุง ูุงฺูโุง ุชูุณุนู ุงูุชูโุงูุฏ. ฺฉ ุงุฒ ุฑูุดโูุง ุงุจุชุฏุง ู ูุญุจูุจุ **Word2Vec** ุงุณุช. ุงู ุฑูุด ุงุฒ ฺฉ ูุนูุงุฑ ุดุจฺฉู ุนุตุจ ุจุฑุง ุชููุฏ ุจุฑุฏุงุฑูุง ูุงฺูโุง ุงุณุชูุงุฏู ูโฺฉูุฏุ ุจูโุทูุฑโฺฉู ุง **ฺฉููู ูุฏู ุฑุง ุจุฑ ุงุณุงุณ ฺฉููุงุช ุฒููู ูพุดโุจู ูโฺฉูุฏ** ุง ุจุงูุนฺฉุณ. ุงุฏู ุงุตู Word2Vec ุงู ุงุณุช ฺฉู **ฺฉููุงุช ฺฉู ุฏุฑ ุฒูููโูุง ูุดุงุจู ุธุงูุฑ ูโุดููุฏุ ูุนุงู ูุดุงุจู ุฏุงุฑูุฏ**. ุจู ููู ุฏููุ ุฒูุงู ฺฉู ุงู ุจุฑุฏุงุฑูุง ุฑุง ุจู ุฏู ุจุนุฏ ฺฉุงูุด ูโุฏูู ุชุง ุจูโุตูุฑุช ฺฏุฑุงูฺฉ ููุงุด ุฏุงุฏู ุดููุฏุ ูุงฺูโูุง ูุดุงุจู ุฏุฑ ฺฉูุงุฑ ฺฉุฏฺฏุฑ ูุฑุงุฑ ูโฺฏุฑูุฏ. **ุดฺฉู ฒ.ณ** ุงู ูพุฏุฏู ุฑุง ููุงุด ูโุฏูุฏ.

ุชุนุจูโูุง ูุงฺูโุง ูโุชูุงููุฏ ุงุจุนุงุฏ ูุฎุชูู ุฏุงุดุชู ุจุงุดูุฏุ ุงุฒ ฺฉ ุจุนุฏ ฺฏุฑูุชู ุชุง ูุฒุงุฑุงู ุจุนุฏ. ุงูุฒุงุด ุชุนุฏุงุฏ ุงุจุนุงุฏ ูโุชูุงูุฏ ุฑูุงุจุท ุธุฑูโุชุฑ ุจู ฺฉููุงุช ุฑุง ุถุจุท ฺฉูุฏุ ุงูุง **ูุฒูู ูุญุงุณุจุงุช** ุจุดุชุฑ ูุฒ ุจู ููุฑุงู ุฏุงุฑุฏ.

> ุฏุฑ **ุดฺฉู ฒ.ณ**ุ ุจุฑุฏุงุฑูุง ุฏูุจุนุฏ ูุงฺูโูุง ุฏุฑ ฺฉ ูููุฏุงุฑ ูพุฑุงฺฉูุฏฺฏ ุฏูุจุนุฏ ุฑุณู ุดุฏูโุงูุฏ. ุงู ูููุฏุงุฑ ูุดุงู ูโุฏูุฏ ฺฉู ูุงฺูโูุง ุฏุงุฑุง ููุงูู ูุดุงุจูุ ุฏุฑ ูุถุง ุจุฑุฏุงุฑ ุจู ูู ูุฒุฏฺฉโุชุฑูุฏุ ุจุฑุง ูุซุงูุ ุงุณุงู ูพุฑูุฏฺฏุงู ุฏุฑ ูุฒุฏฺฉ ฺฉุฏฺฏุฑ ูุฑุงุฑ ุฏุงุฑูุฏุ ุฏุฑ ุญุงูโฺฉู ูุงู ฺฉุดูุฑูุง ู ุดูุฑูุง ุงุฒ ุขูโูุง ูุงุตูู ุฏุงุฑูุฏ.

ุฏุฑ ุญุงู ฺฉู ูโุชูุงู ุงุฒ ูุฏูโูุง ูุงููุฏ Word2Vec ุจุฑุง ุชููุฏ ุจุฑุฏุงุฑูุง ุชุนุจู ูุงฺู ุงุณุชูุงุฏู ฺฉุฑุฏุ ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ ูุนูููุงู **ุจุฑุฏุงุฑูุง ุชุนุจู ุฎูุฏ ุฑุง ุชููุฏ ูโฺฉููุฏ**. ุงู ุจุฑุฏุงุฑูุง ุจุฎุด ุงุฒ **ูุงู ูุฑูุฏ ูุฏู** ูุณุชูุฏ ู ุฏุฑ ุทูู ุขููุฒุด ูุฏู **ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ**. ูุฒุช ุงู ุฑูุด ุขู ุงุณุช ฺฉู ุชุนุจูโูุง ุจูโุทูุฑ ุฎุงุต ุจุฑุง **ูุธูู ู ุฏุงุฏู ููุฑุฏ ูุธุฑ ุจููู ูโุดููุฏ**ุ ุฏุฑ ุญุงูโฺฉู Word2Vec ุชุนุจูโูุง ุนููู ุชููุฏ ูโฺฉูุฏ.

ุฏุฑ ุงุฏุงูู ุงู ูุตูุ ูุงูโูุง ุชุนุจู ุฑุง ฺฉู ุฏุฑ ูุฏูโูุง ุฒุจุงู ุงุณุชูุงุฏู ูโุดููุฏ ูพุงุฏูโุณุงุฒ ุฎูุงูู ฺฉุฑุฏ. ููฺูู ุฏุฑ ูุตู ุณููุ ุจู **ุจุฑุฏุงุฑูุง ุชุนุจู ุฎุฑูุฌ ุฒูููโูุญูุฑ (contextualized embeddings)** ูุฒ ุฎูุงูู ูพุฑุฏุงุฎุช.

ฺฉ ุงุฒ ฺุงูุดโูุง ููู ุฏุฑ ููุฑุฏ ุชุนุจูโูุง ุจุง ุงุจุนุงุฏ ุจุงูุงุ **ูุญุฏูุฏุช ุฏุฑฺฉ ุจุตุฑ ุงูุณุงู** ู ุงุจุฒุงุฑูุง ฺฏุฑุงูฺฉ ุจุฑุง ููุงุด ุขูโูุงุณุชุ ฺุฑุงฺฉู ูุง ูุนูููุงู ููโุชูุงูู ุจุด ุงุฒ ุณู ุจุนุฏ ุฑุง ุจูโุตูุฑุช ุชุตูุฑ ุฏุฑฺฉ ฺฉูู. ุจู ููู ุฏููุ ุฏุฑ ุดฺฉู ฒ.ณ ููุท ุงุจุนุงุฏ ุฏูฺฏุงูู ููุงุด ุฏุงุฏู ุดุฏู ุงุณุช. ุจุง ุงู ุญุงูุ ุฏุฑ ุนููุ ูุฏูโูุง LLM ูุนูููุงู ุงุฒ ุชุนุจูโูุง ุจุง ุงุจุนุงุฏ ุจุณุงุฑ ุจุงูุง ุงุณุชูุงุฏู ูโฺฉููุฏ.

ุจุฑุง ูููููุ ูุฏูโูุง ฺฉูฺฺฉโุชุฑ GPT-2 (ุจุง ฑฑท ุง ฑฒต ูููู ูพุงุฑุงูุชุฑ) ุงุฒ ุจุฑุฏุงุฑูุง ุจุง **ทถธ ุจูุนุฏ** ุงุณุชูุงุฏู ูโฺฉููุฏ. ุฏุฑ ููุงุจูุ ุจุฒุฑฺฏโุชุฑู ูุณุฎู GPT-3 ุจุง **ฑทต ููุงุฑุฏ ูพุงุฑุงูุชุฑ**ุ ุงุฒ ุจุฑุฏุงุฑูุง ุจุง **ฑฒูฌฒธธ ุจูุนุฏ** ุจูุฑู ูโุจุฑุฏ. ุงู ุงูุชุฎุงุจ ูููุงุฑู ฺฉ **ููุงุฒูู ุจู ฺฉุงุฑุง ู ุจูุฑูโูุฑ ูุญุงุณุจุงุช** ุงุณุช.

ุฏุฑ ุจุฎุด ุจุนุฏุ ูุฑุงุญู ูุงุฒู ุจุฑุง ุขูุงุฏูโุณุงุฒ ุชุนุจูโูุง ููุฑุฏ ุงุณุชูุงุฏู ุฏุฑ ูุฏูโูุง ุฒุจุงู ุฑุง ุจุฑุฑุณ ุฎูุงูู ฺฉุฑุฏ. ุงู ูุฑุงุญู ุดุงูู **ุชูุณู ูุชู ุจู ฺฉููุงุชุ ุชุจุฏู ฺฉููุงุช ุจู ุชูฺฉู ู ุณูพุณ ุชุจุฏู ุชูฺฉูโูุง ุจู ุจุฑุฏุงุฑูุง ุชุนุจู** ุงุณุช.

---

## ฒ.ฒ ุชูฺฉูุฒูโฺฉุฑุฏู ูุชู

ุฏุฑ ุงู ุจุฎุดุ ุจู ุจุฑุฑุณ ูุญูู ุชูุณู ูุชู ูุฑูุฏ ุจู **ุชูฺฉูโูุง ุฌุฏุงฺฏุงูู** ูโูพุฑุฏุงุฒูุ ุงู ฺฉุงุฑ ฺฉ ุงุฒ ูุฑุงุญู ุถุฑูุฑ ูพุดโูพุฑุฏุงุฒุด ุงุณุช ฺฉู ุจุฑุง ุณุงุฎุช ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ (embedding) ุฏุฑ ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM) ุงูุฌุงู ูโุดูุฏ. ุงู ุชูฺฉูโูุง ูโุชูุงููุฏ **ูุงฺูโูุง ูุณุชูู ุง ููุณูโูุง ุฎุงุต** ูุงููุฏ ุนูุงุฆู ูฺฏุงุฑุด ุจุงุดูุฏุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ุดฺฉู ฒ.ด ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช.

> **ุดฺฉู ฒ.ด**: ููุง ุงุฒ ูุฑุงุญู ูพุฑุฏุงุฒุด ูุชู ุฏุฑ ุฒููู ูุฏูโูุง ุฒุจุงู. ุฏุฑ ุงูุฌุงุ ูุชู ูุฑูุฏ ุจู ุชูฺฉูโูุง ูุฌุฒุง ุดุงูู ูุงฺูโูุง ุง ููุณูโูุง ูุงููุฏ ุนูุงุฆู ูฺฏุงุฑุด ุชูุณู ูโุดูุฏ.

ูุชู ฺฉู ุฏุฑ ุงูุฌุง ุจุฑุง ุขููุฒุด ูุฏู LLM ุชูฺฉูุฒู ูโฺฉููุ ุฏุงุณุชุงู ฺฉูุชุงู **"The Verdict"** ุงุซุฑ **ุงุฏุช ูุงุฑุชูู** ุงุณุช ฺฉู ุจู ุฏูู ูุฑุงุฑ ฺฏุฑูุชู ุฏุฑ ูุงูฺฉุช ุนููู (public domain)ุ ุงุณุชูุงุฏู ุงุฒ ุขู ุฏุฑ ูพุฑูฺูโูุง ุขููุฒุด ูุฌุงุฒ ุงุณุช. ุงู ูุชู ุฏุฑ ูฺฉโุณูุฑุณ ุฏุฑ ุขุฏุฑุณ ุฒุฑ ููุฌูุฏ ุงุณุช:

[https://en.wikisource.org/wiki/The_Verdict](https://en.wikisource.org/wiki/The_Verdict)

ูโุชูุงูุฏ ุงู ูุชู ุฑุง ฺฉูพ ฺฉุฑุฏู ู ุฏุฑ ฺฉ ูุงู ูุชู ุจู ูุงู `the-verdict.txt` ุฐุฎุฑู ฺฉูุฏ.

ููฺููุ ุงู ูุงู ุฏุฑ ูุฎุฒู ฺฏุชโูุงุจ ูุฑุจูุท ุจู ฺฉุชุงุจ ูุฒ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช:

[https://mng.bz/Adng](https://mng.bz/Adng)

ุจุฑุง ุฏุงูููุฏ ูุณุชูู ุงู ูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุงุชููุ ูโุชูุงู ุงุฒ ฺฉุฏ ุฒุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ:

```
import urllib.request
url = ("https://raw.githubusercontent.com/rasbt/LLMs-from-scratch/main/ch02/01_main-chapter-code/the-verdict.txt")
file_path = "the-verdict.txt"
urllib.request.urlretrieve(url, file_path)
```

ุณูพุณ ูโุชูุงู ุงู ูุงู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑูุง ุงุณุชุงูุฏุงุฑุฏ ุฎูุงูุฏู ูุงู ุฏุฑ ูพุงุชูู ุจุงุฑฺฏุฐุงุฑ ฺฉุฑุฏ:

> **ูุณุช ฒ.ฑ: ุจุงุฑฺฏุฐุงุฑ ูุชู ุฏุงุณุชุงู ุจูโุนููุงู ููููู ูุฑูุฏ ุฏุฑ ูพุงุชูู**

```
with open("the-verdict.txt", "r", encoding="utf-8") as f:
    raw_text = f.read()
print("Total number of character:", len(raw_text))
print(raw_text[:99])
```

ุฎุฑูุฌ ุงู ฺฉุฏ ุดุงูู ุชุนุฏุงุฏ ฺฉู ููุณูโูุง ู ฑฐฐ ููุณู ุงูู ูุงู ุงุณุช:

```
Total number of character: 20479
I HAD always thought Jack Gisburn rather a cheap genius--though a good fellow enough--so it was no
```

ูุฏู ูุงุ **ุชูฺฉูุฒูโฺฉุฑุฏู** ุงู ุฏุงุณุชุงู ฒฐดทน ููุณูโุง ุจู ูุงฺูโูุง ู ููุณูโูุง ุฎุงุต ุฌุฏุงฺฏุงูู ุงุณุชุ ุชุง ุจุชูุงูู ุขูโูุง ุฑุง ุจู embedding ุจุฑุง ุขููุฒุด ูุฏู LLM ุชุจุฏู ฺฉูู.

> ๐ **ูฺฉุชู:** ุฏุฑ ฺฉุงุฑุจุฑุฏูุง ูุงูุน ูุฏูโูุง ุฒุจุงูุ ูุนูููุงู ุจุง ููููโูุง ููุงูู ู ุตุฏูุง ูุฒุงุฑ ฺฉุชุงุจ (ุญุฌู ุฏุฑ ุญุฏ ฺูุฏู ฺฏฺฏุงุจุงุช ูุชู) ฺฉุงุฑ ูโุดูุฏ. ุงูุง ุจุฑุง ุงูุฏุงู ุขููุฒุดุ ฺฉุงุฑ ุจุง ูููููโูุง ฺฉูฺฺฉโุชุฑ (ูุงููุฏ ฺฉ ุฏุงุณุชุงู ฺฉูุชุงู) ฺฉุงู ุงุณุช ู ุงุฌุฑุง ุขู ูุฒ ุฑู ุณุฎุชโุงูุฒุงุฑูุง ุฎุงูฺฏ ุงูฺฉุงูโูพุฐุฑ ูโุจุงุดุฏ.

---

### ุงุณุชูุงุฏู ุงุฒ Regular Expression ุจุฑุง ุชูฺฉูุฒูโฺฉุฑุฏู

ฺฺฏููู ูโุชูุงู ุงู ูุชู ุฑุง ุจู ุจูุชุฑู ุดฺฉู ุจู ููุฑุณุช ุงุฒ ุชูฺฉูโูุง ุชูุณู ฺฉุฑุฏุ ุจุฑุง ุจุฑุฑุณ ุงู ููุถูุนุ ุงุฒ ฺฉุชุงุจุฎุงูู `re` ุฏุฑ ูพุงุชูู (ูุฎุตูุต ฺฉุงุฑ ุจุง ุนุจุงุฑุงุช ุจุงูุงุนุฏู) ุงุณุชูุงุฏู ูโฺฉูู. ูุงุฒ ุจู ุญูุธ ุฏุณุชูุฑ ุฒุจุงู ุนุจุงุฑุงุช ุจุงูุงุนุฏู ูุณุชุ ุฒุฑุง ุฏุฑ ุงุฏุงูู ุงุฒ ุชูฺฉูุฒุฑูุง ุขูุงุฏู ุงุณุชูุงุฏู ุฎูุงูู ฺฉุฑุฏ.

ุฏุฑ ุงุจุชุฏุงุ ุงุฒ ูุชู ุณุงุฏู ุจุฑุง ุขุฒูุงุด ุงุณุชูุงุฏู ูโฺฉูู ู ุงุฒ ุชุงุจุน `re.split` ุจุฑุง ุชูุณู ูุชู ุจุฑ ุงุณุงุณ ูุถุงูุง ุฎุงู ุงุณุชูุงุฏู ูโฺฉูู:

```
import re
text = "Hello, world. This, is a test."
result = re.split(r'(\s)', text)
print(result)
```

ุฎุฑูุฌ:

```
['Hello,', ' ', 'world.', ' ', 'This,', ' ', 'is', ' ', 'a', ' ', 'test.']
```

ุฏุฑ ุงู ุฑูุดุ ูุชู ุจูโุฎูุจ ุจู ูุงฺูโูุง ุฌุฏุง ูโุดูุฏุ ุงูุง ุจุฑุฎ ุงุฒ ูุงฺูโูุง ูููุฒ ุจู ุนูุงุฆู ูฺฏุงุฑุด ูุชุตู ูุณุชูุฏ. ูุง ููฺูู ุงุฒ ุชุจุฏู ุญุฑูู ุจู ุญุงูุช lowercase ุตุฑูโูุธุฑ ูโฺฉููุ ุฒุฑุง **ุญุณุงุณุช ุจู ุญุฑูู ุจุฒุฑฺฏ ู ฺฉูฺฺฉ** ุจู ูุฏู ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุชูุงูุช ูุงู ุงุณู ุฎุงุต ู ุงุณู ุนุงู ุฑุง ุชุดุฎุต ุฏูุฏ ู ุณุงุฎุชุงุฑ ุฌููู ุฑุง ุจูุชุฑ ุฏุฑฺฉ ฺฉูุฏ.

ุจุฑุง ุจูุจูุฏุ ุนุจุงุฑุช ุจุงูุงุนุฏู ุฑุง ุทูุฑ ุชูุธู ูโฺฉูู ฺฉู ุจุฑ ุงุณุงุณ ูุงุตููุ ฺฉุงูุง ู ููุทู ุชูุณู ฺฉูุฏ:

```
result = re.split(r'([,.]|\s)', text)
print(result)
```

ุฎุฑูุฌ:

```
['Hello', ',', '', ' ', 'world', '.', '', ' ', 'This', ',', '', ' ', 'is', ' ', 'a', ' ', 'test', '.', '']
```

ุฏุฑ ุงู ูุณุฎูุ ูุงฺูโูุง ู ุนูุงุฆู ูฺฏุงุฑุด ุฌุฏุง ุดุฏูโุงูุฏุ ุงูุง ููฺูุงู ฺฉุงุฑุงฺฉุชุฑูุง ุฎุงู (whitespace) ุจุงู ูุงูุฏูโุงูุฏ. ุจุฑุง ุญุฐู ุขูโูุงุ ูโุชูุงู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉุฑุฏ:

```
result = [item for item in result if item.strip()]
print(result)
```

ุฎุฑูุฌ ููุง ุจุฏูู ูุถุงูุง ุฎุงู:

```
['Hello', ',', 'world', '.', 'This', ',', 'is', 'a', 'test', '.']
```

> ๐ **ูฺฉุชู:** ุงูฺฉู ุขุง ุจุงุฏ ูุงุตููโูุง ุฎุงู ุฑุง ุจูโุนููุงู ุชูฺฉู ุญูุธ ฺฉูู ุง ุฎุฑุ ุจุณุชฺฏ ุจู ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ. ุญุฐู ุขูโูุง ูโุชูุงูุฏ ูุตุฑู ุญุงูุธู ู ุฒูุงู ูพุฑุฏุงุฒุด ุฑุง ฺฉุงูุด ุฏูุฏ. ุจุง ุงู ุญุงูุ ูฺฏูโุฏุงุดุชู ูุงุตููโูุง ุจุฑุง ูุชูู ุญุณุงุณ ุจู ุณุงุฎุชุงุฑ (ูุงููุฏ ฺฉุฏ ูพุงุชูู) ุถุฑูุฑ ุงุณุช. ุฏุฑ ุงู ูุซุงูุ ุจุฑุง ุณุงุฏูโุณุงุฒุ ูุงุตููโูุง ุญุฐู ูโุดููุฏ.

---

### ูพุดุชุจุงู ุงุฒ ุนูุงุฆู ูฺฏุงุฑุด ุจุดุชุฑ

ุชูฺฉูุฒุฑ ูุง ุชุง ุงูุฌุง ุฎูุจ ุนูู ฺฉุฑุฏูุ ุงูุง ุจุงุฏ ุขู ุฑุง ุทูุฑ ุจูโุฑูุฒ ฺฉูู ฺฉู ุนูุงุฆู ุจุดุชุฑ ูุซู ุนูุงูุช ุณุคุงูุ ูููโููู ู dashูุง ุฏูุชุง (`--`) ุฑุง ูุฒ ูพุดุชุจุงู ฺฉูุฏ:

```
text = "Hello, world. Is this-- a test?"
result = re.split(r'([,.:;?_!"()\']|--|\s)', text)
result = [item.strip() for item in result if item.strip()]
print(result)
```

ุฎุฑูุฌ:

```
['Hello', ',', 'world', '.', 'Is', 'this', '--', 'a', 'test', '?']
```

> **ุดฺฉู ฒ.ต**: ุชูฺฉูุฒุฑ ูุง ุงฺฉููู ูโุชูุงูุฏ ูุชู ุฑุง ุจู ุชูฺฉูโูุง ุดุงูู ูุงฺูโูุง ู ููุณูโูุง ุฎุงุต ุชูุณู ฺฉูุฏ. ุฏุฑ ุงู ูููููุ ูุชู ุจู ฑฐ ุชูฺฉู ูุฌุฒุง ุชูุณู ุดุฏู ุงุณุช.

---

### ุงุนูุงู ุชูฺฉูุฒุฑ ุจู ูุชู ฺฉุงูู ุฏุงุณุชุงู

ุงฺฉูููุ ุชูฺฉูุฒุฑ ุชูุณุนูโุงูุชู ุฑุง ุฑู ฺฉู ุฏุงุณุชุงู ุงุฏุช ูุงุฑุชูู ุงุนูุงู ูโฺฉูู:

```
preprocessed = re.split(r'([,.:;?_!"()\']|--|\s)', raw_text)
preprocessed = [item.strip() for item in preprocessed if item.strip()]
print(len(preprocessed))
```

ุฎุฑูุฌ:

```
4690
```

ุนู ูุชู ูุง ุจู ดถนฐ ุชูฺฉู ุชูุณู ุดุฏู ุงุณุช (ุจุฏูู ุฏุฑูุธุฑ ฺฏุฑูุชู ูุงุตููโูุง). ุญุงู ณฐ ุชูฺฉู ุงูู ุฑุง ุจุฑุง ุจุฑุฑุณ ฺุงูพ ูโฺฉูู:

```
print(preprocessed[:30])
```

ุฎุฑูุฌ:

```
['I', 'HAD', 'always', 'thought', 'Jack', 'Gisburn', 'rather', 'a', 'cheap', 'genius', '--', 'though', 'a', 'good', 'fellow', 'enough', '--', 'so', 'it', 'was', 'no', 'great', 'surprise', 'to', 'me', 'to', 'hear', 'that', ',', 'in']
```

ุงู ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู ุชูฺฉูุฒุฑ ุจูโุฏุฑุณุช ูุงฺูโูุง ู ุนูุงุฆู ูฺฏุงุฑุด ุฑุง ุงุฒ ูู ุฌุฏุง ฺฉุฑุฏู ุงุณุช.

---

## ฒ.ณ ุชุจุฏู ุชูฺฉูโูุง ุจู ุดูุงุณูโูุง ุนุฏุฏ (Token IDs)

ุฏุฑ ุงู ูุฑุญููุ ูโุฎูุงูู ุชูฺฉูโูุง ุฑุง ฺฉู ูุจูุงู ุชููุฏ ฺฉุฑุฏูโุงูุ ุงุฒ ุฑุดุชูโูุง ูุชู ูพุงุชูู ุจู ููุงุด ุนุฏุฏ ุชุจุฏู ฺฉููุ ุงู ููุงุด ุนุฏุฏ ููุงู **ุดูุงุณู ุชูฺฉูโูุง** (Token IDs) ุงุณุช. ุงู ูุฑุญููุ ฺฉ ฺฏุงู ูุงู ุงุณุช ูพุด ุงุฒ ุขูโฺฉู ุชูฺฉูโูุง ุจู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒโุดุฏู (embedding vectors) ุชุจุฏู ุดููุฏ.

ุจุฑุง ูฺฏุงุดุช (map) ุชูฺฉูโูุง ุจูโุฏุณุชโุขูุฏู ุจู ุดูุงุณูโูุง ุนุฏุฏุ ุงุจุชุฏุง ุจุงุฏ **ูุงฺฺฏุงู (vocabulary)** ุงุฌุงุฏ ฺฉูู. ุงู ูุงฺฺฏุงู ูุดุฎุต ูโฺฉูุฏ ฺฉู ฺฺฏููู ูุฑ ูุงฺู ุง ููุงุฏ ุฎุงุตุ ุจู ฺฉ ุนุฏุฏ ฺฉุชุง ุงุฎุชุตุงุต ุฏุงุฏู ูโุดูุฏ. ุฏุฑ ุดฺฉู ฒ.ถ ุงู ูุฑุขูุฏ ุจูโุชุตูุฑ ฺฉุดุฏู ุดุฏู ุงุณุช.

> **ุดฺฉู ฒ.ถ**: ูุง ูุงฺฺฏุงู ุฑุง ุจุง ุชูฺฉูุฒู ฺฉุฑุฏู ฺฉู ูุชู ฺฉ ูุฌููุนูโุฏุงุฏู ุขููุฒุด ุงุฌุงุฏ ูโฺฉูู. ุชูฺฉูโูุง ุจูโุตูุฑุช ุงููุจุง ูุฑุชุจ ูโุดููุฏ ู ูููููโูุง ุชฺฉุฑุงุฑ ุญุฐู ูโฺฏุฑุฏูุฏ. ุชูฺฉูโูุง ููุญุตุฑุจูโูุฑุฏ ุณูพุณ ุฏุฑ ูุงูุจ ฺฉ ูุงฺฺฏุงู ฺฏุฑุฏุขูุฑ ูโุดููุฏ ฺฉู ุฏุฑ ุขูุ ูุฑ ุชูฺฉู ุจู ฺฉ ุนุฏุฏ ฺฉุชุง ูฺฏุงุดุช ูโุดูุฏ. (ุจุฑุง ุณุงุฏูโุณุงุฒุ ุฏุฑ ุงู ูุงฺฺฏุงู ูุดุงููโฺฏุฐุงุฑโูุง ุง ููุงุฏูุง ุฎุงุต ูุญุงุธ ูุดุฏูโุงูุฏ.)

ุงฺฉููู ฺฉู ุฏุงุณุชุงู ฺฉูุชุงู "The Verdict" ุงุฒ ุงุฏุช ูุงุฑุชูู ุฑุง ุชูฺฉูุฒู ฺฉุฑุฏู ู ุขู ุฑุง ุฏุฑ ูุชุบุฑ ุจู ูุงู `preprocessed` ุฐุฎุฑู ฺฉุฑุฏูโุงูุ ูุตุฏ ุฏุงุฑู ููุฑุณุช ุงุฒ ุชูุงู ุชูฺฉูโูุง ููุญุตุฑุจูโูุฑุฏ ุงุฌุงุฏ ฺฉููุ ุขูโูุง ุฑุง ุจู ุชุฑุชุจ ุงููุจุง ูุฑุชุจ ฺฉูู ู ุงูุฏุงุฒู ูุงฺฺฏุงู ุฑุง ุชุนู ฺฉูู:

```
all_words = sorted(set(preprocessed))
vocab_size = len(all_words)
print(vocab_size)
```

ูพุณ ุงุฒ ุงุฌุฑุง ุงู ฺฉุฏุ ุฏุฑูโุงุจู ฺฉู ุงูุฏุงุฒู ูุงฺฺฏุงู ุจุฑุงุจุฑ ุจุง ฑฑณฐ ุงุณุช. ุญุงูุ ูุงฺฺฏุงู ุฑุง ูโุณุงุฒู ู ุจุฑุง ูููููุ ตฑ ููุฑุฏ ุงูู ุขู ุฑุง ฺุงูพ ูโฺฉูู.

> **ูุณุช ฒ.ฒ: ุณุงุฎุช ูุงฺฺฏุงู**

```
vocab = {token:integer for integer,token in enumerate(all_words)}
for i, item in enumerate(vocab.items()):
    print(item)
    if i >= 50:
        break
('!', 0)
('"', 1)
("'", 2)
...
('Her', 49)
('Hermia', 50)
```

ููุงูโุทูุฑ ฺฉู ูโุจููุ ุงู ูุงฺฺฏุงู ุจูโุตูุฑุช ฺฉ ุฏฺฉุดูุฑ ูพุงุฏูโุณุงุฒ ุดุฏู ฺฉู ุฏุฑ ุขูุ ูุฑ ุชูฺฉู ุจุง ฺฉ ุดูุงุณู ุนุฏุฏ ฺฉุชุง ูุฑุชุจุท ุดุฏู ุงุณุช. ฺฏุงู ุจุนุฏ ูุงุ ุงุณุชูุงุฏู ุงุฒ ุงู ูุงฺฺฏุงู ุจุฑุง ุชุจุฏู ูุชู ุฌุฏุฏ ุจู ุดูุงุณูโูุง ุชูฺฉู ุงุณุช (ุดฺฉู ฒ.ท).

> **ุดฺฉู ฒ.ท**: ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ููููู ูุชู ุฌุฏุฏุ ุงุจุชุฏุง ุขู ุฑุง ุชูฺฉูุฒู ูโฺฉูู ู ุณูพุณ ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงฺฺฏุงูุ ุชูฺฉูโูุง ุฑุง ุจู ุดูุงุณูโูุง ุนุฏุฏ ุชุจุฏู ูโฺฉูู. ูุงฺฺฏุงู ุงุฒ ฺฉู ูุฌููุนู ุขููุฒุด ุณุงุฎุชู ุดุฏู ู ูโุชูุงูุฏ ูู ุจุฑุง ุฏุงุฏูโูุง ุขููุฒุด ู ูู ุจุฑุง ูุชูู ุฌุฏุฏ ุจูโฺฉุงุฑ ุฑูุฏ. (ุฏุฑ ุงู ูุงฺฺฏุงู ูุฒ ูุดุงููโฺฏุฐุงุฑ ูุญุงุธ ูุดุฏู ุงุณุช.)

ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ุฎุฑูุฌ ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM) ุงุฒ ุดฺฉู ุนุฏุฏ ุจู ูุชูุ ูุงุฒ ุฏุงุฑู ุดูุงุณูโูุง ุชูฺฉู ุฑุง ุฏูุจุงุฑู ุจู ุชูฺฉูโูุง ูุชู ุชุจุฏู ฺฉูู. ุจุฑุง ุงู ฺฉุงุฑุ ูุณุฎู ูุนฺฉูุณ ูุงฺฺฏุงู ุฑุง ุงุฌุงุฏ ูโฺฉูู ฺฉู ุฏุฑ ุขูุ ูุฑ ุดูุงุณู ุนุฏุฏ ุจู ุชูฺฉู ูุชูุงุธุฑ ุฎูุฏ ูฺฏุงุดุช ูโุดูุฏ.

ุงฺฉููู ูุตุฏ ุฏุงุฑู ฺฉ **ฺฉูุงุณ ุณุงุฏู ุจุฑุง ุชูฺฉูุฒูโุณุงุฒ ูุชู** ุฏุฑ ูพุงุชูู ูพุงุฏูโุณุงุฒ ฺฉูู. ุงู ฺฉูุงุณ ุดุงูู ฺฉ ูุชุฏ `encode` ุฎูุงูุฏ ุจูุฏ ฺฉู ูุชู ุฑุง ุจู ุชูฺฉูโูุง ุชูุณู ฺฉุฑุฏู ู ุขูโูุง ุฑุง ุจู ุดูุงุณู ุนุฏุฏ ุชุจุฏู ูโฺฉูุฏุ ู ููฺูู ูุชุฏ `decode` ฺฉู ูุฑุขูุฏ ูุนฺฉูุณ ุฑุง ุงูุฌุงู ุฏุงุฏู ู ุดูุงุณูโูุง ุนุฏุฏ ุฑุง ุจู ูุชู ุจุงุฒูโฺฏุฑุฏุงูุฏ.

> **ูุณุช ฒ.ณ: ูพุงุฏูโุณุงุฒ ฺฉ ุชูฺฉูุฒุฑ ุณุงุฏู ุฏุฑ ูพุงุชูู**

```
class SimpleTokenizerV1:
    def __init__(self, vocab):
        self.str_to_int = vocab
        self.int_to_str = {i: s for s, i in vocab.items()}

    def encode(self, text):
        preprocessed = re.split(r'([,.?_!"()\']|--|\s)', text)
        preprocessed = [
            item.strip() for item in preprocessed if item.strip()
        ]
        ids = [self.str_to_int[s] for s in preprocessed]
        return ids

    def decode(self, ids):
        text = " ".join([self.int_to_str[i] for i in ids])
        text = re.sub(r'\s+([,.?!"()\'])', r'\1', text)
        return text
```

ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุงุณ `SimpleTokenizerV1`ุ ุงฺฉููู ูโุชูุงูู ฺฉ ุด ุฌุฏุฏ ุงุฒ ุงู ฺฉูุงุณ ุจุณุงุฒู ู ุจุง ฺฉูฺฉ ูุงฺฺฏุงู ููุฌูุฏุ ูุชู ุฑุง ุชูฺฉูุฒู ู ุณูพุณ ุจุงุฒุณุงุฒ ฺฉูู. ุจุงุฏ ุงู ฺฉุงุฑ ุฑุง ุจุง ฺฉ ูุทุนู ุงุฒ ุฏุงุณุชุงู ุงุฏุช ูุงุฑุชูู ุงูุฌุงู ุฏูู:

```
tokenizer = SimpleTokenizerV1(vocab)
text = """"It's the last he painted, you know,"
Mrs. Gisburn said with pardonable pride."""
ids = tokenizer.encode(text)
print(ids)
```

ุฎุฑูุฌ ฺฉุฏ ุจุงูุง ฺูู ุฎูุงูุฏ ุจูุฏ:

```
[1, 56, 2, 850, 988, 602, 533, 746, 5, 1126, 596, 5, 1, 67, 7, 38, 851, 1108,754, 793, 7]
```

ุฏุฑ ฺฏุงู ุจุนุฏุ ุจุฑุฑุณ ูโฺฉูู ฺฉู ุขุง ูโุชูุงูู ุงู ุดูุงุณูโูุง ุฑุง ุฏูุจุงุฑู ุจู ูุชู ุชุจุฏู ฺฉูู:

```
print(tokenizer.decode(ids))
```

> **ุดฺฉู ฒ.ธ**: ุชูฺฉูุฒุฑูุง ูุนูููุงู ุฏู ูุชุฏ ุงุตู ุฏุงุฑูุฏ: `encode` ุจุฑุง ุชุจุฏู ูุชู ุจู ุดูุงุณู ุชูฺฉูุ ู `decode` ุจุฑุง ุชุจุฏู ุดูุงุณู ุชูฺฉู ุจู ูุชู. ุงุจุชุฏุง ูุชู ุจู ุชูฺฉูโูุง ุฌุฏุงฺฏุงูู ุชูุณู ูโุดูุฏุ ุณูพุณ ุจู ุดูุงุณู ุชุจุฏู ูโฺฏุฑุฏุฏ. ุฏุฑ ูุฑุญูู ูุนฺฉูุณุ ุดูุงุณูโูุง ุจู ุชูฺฉู ุชุจุฏู ุดุฏู ู ุจูโุตูุฑุช ุฑุดุชูโุง ูุงุจู ุฎูุงูุฏู ุฏุฑ ูโุขูุฏ.

ุฎุฑูุฌ:

```
'" It\' s the last he painted, you know," Mrs. Gisburn said with pardonable pride.'
```

ุงู ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู ูุชุฏ `decode` ุจุง ููููุช ุชูุงูุณุชู ุดูุงุณูโูุง ุนุฏุฏ ุฑุง ุจู ูุชู ุงุตู ุจุงุฒฺฏุฑุฏุงูุฏ.

ุชุง ุงูุฌุงุ ูุง ฺฉ ุชูฺฉูุฒุฑ ุทุฑุงุญ ฺฉุฑุฏูโุงู ฺฉู ูโุชูุงูุฏ ูุชู ุงุฒ ูุฌููุนู ุขููุฒุด ุฑุง ุชูฺฉูุฒู ู ุณูพุณ ุขู ุฑุง ุจุงุฒุณุงุฒ ฺฉูุฏ. ุญุงู ุจุงุฏ ุขู ุฑุง ุฑู ฺฉ ููููู ูุชู ุฌุฏุฏ ุงูุชุญุงู ฺฉูู:

```
text = "Hello, do you like tea?"
print(tokenizer.encode(text))
```

ุงูุง ุงุฌุฑุง ุงู ฺฉุฏ ููุฌุฑ ุจู ุฎุทุง ุฒุฑ ุฎูุงูุฏ ุดุฏ:

```
KeyError: 'Hello'
```

ุฏูู ุฎุทุง ุขู ุงุณุช ฺฉู ูุงฺู "Hello" ุฏุฑ ุฏุงุณุชุงู "The Verdict" ูุฌูุฏ ูุฏุงุดุชู ู ุฏุฑ ูุชุฌู ุฏุฑ ูุงฺฺฏุงู ูุฒ ูุงูุฏู ุงุณุช. ุงู ููุถูุน ูุดุงู ูโุฏูุฏ ฺฉู ุจุฑุง ฺฉุงุฑ ุจุง ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM)ุ ุถุฑูุฑ ุงุณุช ฺฉู ูุฌููุนูโุฏุงุฏู ุขููุฒุด **ฺฏุณุชุฑุฏู ู ูุชููุน** ุจุงุดุฏ ุชุง ูุงฺฺฏุงู ุญุงุตู ุจุชูุงูุฏ ฺฉููุงุช ุฌุฏุฏ ุฑุง ูุฒ ูพูุดุด ุฏูุฏ.

ุฏุฑ ุงุฏุงููุ ุชูฺฉูุฒุฑ ุฑุง ุจุง ูุชูู ุขุฒูุงุด ูโฺฉูู ฺฉู ุญุงู ูุงฺฺฏุงู ูุงุดูุงุฎุชู ูุณุชูุฏ ู ุณูพุณ ุจู ุจุฑุฑุณ **ุชูฺฉูโูุง ุฎุงุต** (special tokens) ูโูพุฑุฏุงุฒู ฺฉู ุฏุฑ ุขููุฒุด ูุฏูโูุง ุฒุจุงู ุจู ุขูโูุง ุฒููู ู ุณุงุฎุชุงุฑ ุจุดุชุฑ ูโุฏููุฏ.

---

## ฒ.ด ุงูุฒูุฏู ุชูฺฉูโูุง ุฎุงุต ุฒูููโุง

ุฏุฑ ุงู ุจุฎุดุ ูุตุฏ ุฏุงุฑู ุชูฺฉูุฒุฑ ุฑุง ุจูโฺฏูููโุง ุงุตูุงุญ ฺฉูู ฺฉู ุจุชูุงูุฏ ูุงฺูโูุง ูุงุดูุงุฎุชู ุฑุง ูุฏุฑุช ฺฉุฑุฏู ู ููฺูู ุชูฺฉูโูุง ุฎุงุต ุฑุง ุจุฑุง ูุฑุงููโฺฉุฑุฏู **ุฒููู (context)** ุจูุชุฑ ุจู ูุฏู ุฒุจุงู ุงุถุงูู ฺฉูุฏ. ุงู ุชูฺฉูโูุง ุฎุงุต ูโุชูุงููุฏ ุดุงูู ูุดุงูฺฏุฑูุง ุจุฑุง ูุงฺูโูุง ูุงุดูุงุฎุชู ู **ูุฑุฒ ุจู ุงุณูุงุฏ** ูุฎุชูู ุจุงุดูุฏ.

ุจูโุทูุฑ ูุดุฎุตุ ูุฑุงุฑ ุงุณุช ูุงฺฺฏุงู ู ุชูฺฉูุฒุฑ ุฑุง ุจู ูุณุฎูโุง ุฌุฏุฏ ุจู ูุงู `SimpleTokenizerV2` ุงุฑุชูุง ุฏูู ุชุง ุงุฒ ุฏู ุชูฺฉู ุฌุฏุฏ ูพุดุชุจุงู ฺฉูุฏ:

- ุชูฺฉู `<|unk|>`: ููุงูุฏูโ ูุงฺูโูุง ูุงุดูุงุฎุชูโุง ุงุณุช ฺฉู ุฏุฑ ุฏุงุฏูโ ุขููุฒุด ูุฏู ูุฌูุฏ ูุฏุงุดุชูโุงูุฏ.
- ุชูฺฉู `<|endoftext|>`: ูุดุงูโุฏููุฏูโ ูพุงุงู ฺฉ ูุชู ุง ุณูุฏ ูุณุชูู ุงุณุช.

> **ุดฺฉู ฒ.น**: ุจุง ุงูุฒูุฏู ุชูฺฉูโูุง ุฎุงุต ุจู ูุงฺฺฏุงูุ ูโุชูุงู ุดุฑุงุท ุฎุงุต ุฑุง ูุฏุฑุช ฺฉุฑุฏ. ุจุฑุง ูุซุงูุ `<|unk|>` ููุงูุฏูโ ูุงฺูโูุง ุงุณุช ฺฉู ุฏุฑ ุฏุงุฏูโ ุขููุฒุด ูุฏู ูุฌูุฏ ูุฏุงุดุชูโุงูุฏ. ููฺูู ุชูฺฉู `<|endoftext|>` ูโุชูุงูุฏ ุจุฑุง ุฌุฏุง ฺฉุฑุฏู ุฏู ูุชู ูุณุชูู ุงุณุชูุงุฏู ุดูุฏ.

ููฺฏุงู ฺฉู ฺฉ ุชูฺฉูุฒุฑ ุจุง ูุงฺูโุง ููุงุฌู ูโุดูุฏ ฺฉู ุฏุฑ ูุงฺฺฏุงู (vocabulary) ูุฌูุฏ ูุฏุงุฑุฏุ ูโุชูุงู ุขู ุฑุง ุจุง ุชูฺฉู `<|unk|>` ุฌุงฺฏุฒู ฺฉุฑุฏ. ููฺููุ ุฏุฑ ุฒูุงู ฺฉู ุงุฒ ฺูุฏ ุณูุฏ ูุณุชูู ุจุฑุง ุขููุฒุด ุงุณุชูุงุฏู ูโุดูุฏุ ุฑุงุฌ ุงุณุช ฺฉู ุจู ูุฑ ุฏู ูุชูุ ุชูฺฉู `<|endoftext|>` ูุฑุงุฑ ุฏุงุฏู ุดูุฏ.

> **ุดฺฉู ฒ.ฑฐ**: ุฏุฑ ููุงูุน ฺฉู ุงุฒ ฺูุฏ ููุจุน ูุชู ูุณุชูู ุงุณุชูุงุฏู ูโุดูุฏุ ุงูุฒูุฏู ุชูฺฉู `<|endoftext|>` ุจู ุขูโูุง ุจุงุนุซ ูโุดูุฏ ูุฏู LLM ุจุชูุงูุฏ ุชุดุฎุต ุฏูุฏ ฺฉู ุงู ูุชูู ุจู ูู ูุฑุชุจุท ูุณุชูุฏ. ุงู ฺฉุงุฑ ุจู ูุฏู ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุณุงุฎุชุงุฑ ูุชู ุฑุง ุจูุชุฑ ุฏุฑฺฉ ฺฉูุฏ.

---

### ุงูุฒูุฏู ุชูฺฉูโูุง ุฎุงุต ุจู ูุงฺฺฏุงู

ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุงู ุชูฺฉูโูุง ุจู ูุงฺฺฏุงู ููุฌูุฏุ ุงุจุชุฏุง ููุฑุณุช ุงุฒ ูููโ ุชูฺฉูโูุง ููุญุตุฑุจูโูุฑุฏ ููุฌูุฏ ุฏุฑ ูุชู ุชูู ูโฺฉูู ู ุณูพุณ ุงู ุฏู ุชูฺฉู ุฎุงุต ุฑุง ุจู ุขู ุงุถุงูู ูโููุงู:

```
all_tokens = sorted(list(set(preprocessed)))
all_tokens.extend(["<|endoftext|>", "<|unk|>"])
vocab = {token: integer for integer, token in enumerate(all_tokens)}
print(len(vocab.items()))
```

ุฎุฑูุฌ ูุดุงู ูโุฏูุฏ ฺฉู ุงูุฏุงุฒู ูุงฺฺฏุงู ุฌุฏุฏ **ฑฑณฒ** ุงุณุช (ุฏุฑ ุญุงู ฺฉู ูพุด ุงุฒ ุงู ฑฑณฐ ุจูุฏ).

ุจุฑุง ุจุฑุฑุณุ ูพูุฌ ูุฑูุฏ ุขุฎุฑ ูุงฺฺฏุงู ุฑุง ฺุงูพ ูโฺฉูู:

```
for i, item in enumerate(list(vocab.items())[-5:]):
    print(item)
```

ุฎุฑูุฌ:

```
('younger', 1127)
('your', 1128)
('yourself', 1129)
('<|endoftext|>', 1130)
('<|unk|>', 1131)
```

ุงู ุฎุฑูุฌ ุชุฃุฏ ูโฺฉูุฏ ฺฉู ุฏู ุชูฺฉู ูฺู ุจุง ููููุช ุจู ูุงฺฺฏุงู ุงุถุงูู ุดุฏูโุงูุฏ.

---

### ูพุงุฏูโุณุงุฒ ุชูฺฉูุฒุฑ ุจุง ูพุดุชุจุงู ุงุฒ ูุงฺูโูุง ูุงุดูุงุฎุชู

ุฏุฑ ูุณุฎู ุฌุฏุฏ ุชูฺฉูุฒุฑุ ุนู `SimpleTokenizerV2`ุ ูุงฺูโูุง ฺฉู ุฏุฑ ูุงฺฺฏุงู ูุณุชูุฏ ุจุง ุชูฺฉู `<|unk|>` ุฌุงฺฏุฒู ูโุดููุฏ. ูพุงุฏูโุณุงุฒ ุขู ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

> **ูุณุช ฒ.ด: ุชูฺฉูุฒุฑ ุณุงุฏู ฺฉู ูุงฺูโูุง ูุงุดูุงุฎุชู ุฑุง ูุฏุฑุช ูโฺฉูุฏ**

```
class SimpleTokenizerV2:
    def __init__(self, vocab):
        self.str_to_int = vocab
        self.int_to_str = {i: s for s, i in vocab.items()}

    def encode(self, text):
        preprocessed = re.split(r'([,.:;?_!"()\']|--|\s)', text)
        preprocessed = [
            item.strip() for item in preprocessed if item.strip()
        ]
        preprocessed = [
            item if item in self.str_to_int else "<|unk|>" for item in preprocessed
        ]
        ids = [self.str_to_int[s] for s in preprocessed]
        return ids

    def decode(self, ids):
        text = " ".join([self.int_to_str[i] for i in ids])
        text = re.sub(r'\s+([,.:;?!"()\'])', r'\1', text)
        return text
```

ุชูุงูุช ุงู ูุณุฎู ุจุง ูุณุฎูโ ูุจู (`SimpleTokenizerV1`) ุฏุฑ ุงู ุงุณุช ฺฉู ุงฺฉููู **ูุงฺูโูุง ุฎุงุฑุฌ ุงุฒ ูุงฺฺฏุงู** ุจุง `<|unk|>` ุฌุงฺฏุฒู ูโุดููุฏ.

---

### ุขุฒูุงุด ุชูฺฉูุฒุฑ ุฌุฏุฏ ุฏุฑ ุนูู

ุฏุฑ ุงุฏุงููุ ุฏู ุฌูููโ ูุณุชูู ุฑุง ุจุง ุชูฺฉู `<|endoftext|>` ุงุฒ ูู ุฌุฏุง ฺฉุฑุฏู ู ุจู ุชูฺฉูุฒุฑ ูโุฏูู:

```
text1 = "Hello, do you like tea?"
text2 = "In the sunlit terraces of the palace."
text = " <|endoftext|> ".join((text1, text2))
print(text)
```

ุฎุฑูุฌ:

```
Hello, do you like tea? <|endoftext|> In the sunlit terraces of the palace.
```

ุงฺฉููู ูุชู ุชุฑฺฉุจ ุฑุง ุจุง `SimpleTokenizerV2` ุชูฺฉูุฒู ูโฺฉูู:

```
tokenizer = SimpleTokenizerV2(vocab)
print(tokenizer.encode(text))
```

ุฎุฑูุฌ ุชูฺฉู ุขุฏโูุง:

```
[1131, 5, 355, 1126, 628, 975, 10, 1130, 55, 988, 956, 984, 722, 988, 1131, 7]
```

ุฏุฑ ุงู ุฎุฑูุฌ:

- **ุนุฏุฏ 1130** ูุฑุจูุท ุจู ุชูฺฉู `<|endoftext|>` ุงุณุช.
- **ุนุฏุฏ 1131** ุฏู ุจุงุฑ ุชฺฉุฑุงุฑ ุดุฏู ู ูุดุงูโุฏููุฏูโ ูุงฺูโูุง ูุงุดูุงุฎุชู (ุนู โHelloโ ู โpalaceโ) ุงุณุช.

ุงฺฉููู ูุชู ุชูฺฉูุฒูโุดุฏู ุฑุง ุจู ูุชู ูุงุจู ุฎูุงูุฏู ุชุจุฏู ูโฺฉูู:

```
print(tokenizer.decode(tokenizer.encode(text)))
```

ุฎุฑูุฌ:

```
<|unk|>, do you like tea? <|endoftext|> In the sunlit terraces of the <|unk|>.
```

ููุงูโุทูุฑ ฺฉู ุฏุฏู ูโุดูุฏุ ุฏู ูุงฺูโ "Hello" ู "palace" ฺูู ุฏุฑ ุฏุงุณุชุงู ุงุตู ูุฌูุฏ ูุฏุงุดุชูุฏุ ุจู ุชูฺฉู `<|unk|>` ุชุจุฏู ุดุฏูโุงูุฏ.

---

### ุชูฺฉูโูุง ุฎุงุต ุจุดุชุฑ (ุงุฎุชุงุฑ)

ุจุณุชู ุจู ููุน ูุฏู ุฒุจุงูุ ฺฏุงู ุงุฒ ุชูฺฉูโูุง ุฒูููโุง ุจุดุชุฑ ูุฒ ุงุณุชูุงุฏู ูโุดูุฏ:

- ุชูฺฉู `[BOS]` (ุดุฑูุน ุชูุงู): ูุดุงูโุฏููุฏูโ ุขุบุงุฒ ฺฉ ูุชู ุงุณุช.
- ุชูฺฉู `[EOS]` (ูพุงุงู ุชูุงู): ูุดุงูโุฏููุฏูโ ูพุงุงู ฺฉ ูุชู ุงุณุช ู ุจุฑุง ุชูฺฉฺฉ ูุชูู ูุณุชูู ุจูโูฺู ุฏุฑ ุขููุฒุด ูุฏูโูุง ฺูุฏูุชู ุงุณุชูุงุฏู ูโุดูุฏ. ุนููฺฉุฑุฏ ูุดุงุจู `<|endoftext|>` ุฏุงุฑุฏ.
- ุชูฺฉู `[PAD]` (ูพุฏูฺฏ): ููฺฏุงู ุขููุฒุด ุจุง **ุจฺโูุง ฺูุฏูุชู ุจุง ุทูู ูุชูุงูุช**ุ ุจุฑุง ฺฉุณุงูโุณุงุฒ ุทููุ ูุชูู ฺฉูุชุงูโุชุฑ ุจุง ุงู ุชูฺฉู ุชุง ุทูู ุจููุฏุชุฑู ูุชู ูพูุฑ ูโุดููุฏ.

ุจุง ุงู ุญุงูุ ุชูฺฉูุฒุฑ ูุฏูโูุง GPT ุงุฒ ูฺโฺฉุฏุงู ุงุฒ ุงู ุชูฺฉูโูุง ุงุณุชูุงุฏู ููโฺฉูุฏ. ุฏุฑ GPT ุชููุง ุงุฒ ุชูฺฉู `<|endoftext|>` ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู ุนููฺฉุฑุฏ ูุดุงุจู `[EOS]` ู ุญุช `[PAD]` ุฏุงุฑุฏ. ููฺฏุงู ุงุณุชูุงุฏู ุงุฒ batchingุ ุชูฺฉูโูุง padding ุจุง **ูุงุณฺฉ ฺฉุฑุฏู (masking)** ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏุ ุจูุงุจุฑุงู ููุน ุฏูู ุชูฺฉู padding ฺูุฏุงู ุงููุช ูุฏุงุฑุฏ.

ููฺููุ ุฏุฑ GPT ุจุฑุฎูุงู SimpleTokenizerุ ุงุฒ ุชูฺฉู `<|unk|>` ูุฒ ุงุณุชูุงุฏู ููโุดูุฏ. ุจูโุฌุง ุขูุ GPT ุงุฒ **ุชูฺฉูุฒุฑ ูุจุชู ุจุฑ ุฑูุฒฺฏุฐุงุฑ ุฒูุฌโููุณูโูุง (Byte Pair Encoding - BPE)** ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉู ูุงฺูโูุง ุฑุง ุจู ูุงุญุฏูุง ฺฉูฺฺฉโุชุฑ (ุฒุฑูุงฺูโูุง ุง subword units) ุชูุณู ูโฺฉูุฏ. ุงู ููุถูุน ุฏุฑ ูุตูโูุง ุจุนุฏ ุจุฑุฑุณ ุฎูุงูุฏ ุดุฏ.

---


## ฒ.ต ุฑูุฒฺฏุฐุงุฑ ุฒูุฌโููุณูโูุง (Byte Pair Encoding)

ุฏุฑ ุงู ุจุฎุดุ ุจุง ฺฉ ุฑูุด ูพุดุฑูุชูโุชุฑ ุจุฑุง ุชูฺฉูุฒูโฺฉุฑุฏู ูุชู ุขุดูุง ูโุดูู ฺฉู ุจุฑ ูพุงู ุงูฺฏู ุจู ูุงู **ุฑูุฒฺฏุฐุงุฑ ุฒูุฌโููุณูโูุง (BPE)** ุทุฑุงุญ ุดุฏู ุงุณุช. ุงู ุฑูุด ุจุฑุง ุขููุฒุด ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ ูุงููุฏ **GPT-2ุ GPT-3** ู ูุณุฎู ุงุตู **ChatGPT** ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุชู ุงุณุช.

ุงุฒ ุขูโุฌุง ฺฉู ูพุงุฏูโุณุงุฒ BPE ุงุฒ ุงุจุชุฏุง ูพฺุฏฺฏ ูุณุจุชุงู ุจุงูุง ุฏุงุฑุฏุ ุฏุฑ ุงูุฌุง ุงุฒ ฺฉ **ฺฉุชุงุจุฎุงููโ ูุชูโุจุงุฒ ูพุงุชูู ุจู ูุงู `tiktoken`** ุงุณุชูุงุฏู ูโฺฉูู ฺฉู ุงู ุงูฺฏูุฑุชู ุฑุง ุจู ุดฺฉู ุจุณุงุฑ ุจููู (ุจุง ุงุณุชูุงุฏู ุงุฒ ุฒุจุงู Rust) ูพุงุฏูโุณุงุฒ ฺฉุฑุฏู ุงุณุช.

---

### ูุตุจ ฺฉุชุงุจุฎุงูู `tiktoken`

ุจุฑุง ูุตุจ ุงู ฺฉุชุงุจุฎุงููุ ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุฏุฑ ุชุฑููุงู ุงุณุชูุงุฏู ูโฺฉูู:

```
pip install tiktoken
```

ุจุฑุง ุจุฑุฑุณ ูุณุฎูโ ูุตุจโุดุฏู:

```
from importlib.metadata import version
import tiktoken
print("tiktoken version:", version("tiktoken"))
```

---

### ุงุณุชูุงุฏู ุงุฒ ุชูฺฉูุฒุฑ BPE

ูพุณ ุงุฒ ูุตุจุ ูโุชูุงูู ุชูฺฉูุฒุฑ ูุจุชู ุจุฑ BPE ุฑุง ูุงููุฏ ุฒุฑ ููุฏุงุฑุฏู ฺฉูู:

```
tokenizer = tiktoken.get_encoding("gpt2")
```

ุณุงุฎุชุงุฑ ุงุณุชูุงุฏู ุงุฒ ุงู ุชูฺฉูุฒุฑ ุจุณุงุฑ ุดุจู ุจู `SimpleTokenizerV2` ุงุณุช. ูุซูุงู ุจุฑุง ุชุจุฏู ูุชู ุจู ุชูฺฉูโูุง ุงุฒ ูุชุฏ `encode` ุงุณุชูุงุฏู ูโฺฉูู:

```
text = (
    "Hello, do you like tea? <|endoftext|> In the sunlit terraces"
    "of someunknownPlace."
)
integers = tokenizer.encode(text, allowed_special={"<|endoftext|>"})
print(integers)
```

ุฎุฑูุฌ ุงู ฺฉุฏ ุจู ุดฺฉู ุฒุฑ ุงุณุช:

```
[15496, 11, 466, 345, 588, 8887, 30, 220, 50256, 554, 262, 4252, 18250,
8812, 2114, 286, 617, 34680, 27271, 13]
```

---

### ุชุจุฏู ุฏูุจุงุฑู ุจู ูุชู

ุจุฑุง ุชุจุฏู ุชูฺฉูโูุง ุจู ูุชู ูุงุจู ุฎูุงูุฏูุ ุงุฒ ูุชุฏ `decode` ุงุณุชูุงุฏู ูโฺฉูู:

```
strings = tokenizer.decode(integers)
print(strings)
```

ุฎุฑูุฌ:

```
Hello, do you like tea? <|endoftext|> In the sunlit terraces of someunknownPlace.
```

---

### ุฏู ูฺฉุชู ููู ุฏุฑุจุงุฑูโ ุชูฺฉูโูุง

ฑ. **ุดูุงุณูโ ุชูฺฉู <|endoftext|>** ุนุฏุฏ 50256 ุงุณุช. ุงู ุชูฺฉู ูุนูููุงู ุจุฒุฑฺฏโุชุฑู ุดูุงุณู ุฑุง ุฏุงุฑุฏ ู ูุดุงู ูโุฏูุฏ ฺฉู **ุงูุฏุงุฒูโ ูุงฺฺฏุงู ุชูฺฉูุฒุฑ BPE ุฏุฑ GPT-2 ู GPT-3 ุจุฑุงุจุฑ ุจุง 50,257 ุชูฺฉู** ุงุณุช.

ฒ. **ูุฏุฑุช ูุงฺูโูุง ูุงุดูุงุฎุชู (ูุซูุงู someunknownPlace)** ุจูโุฏุฑุณุช ุงูุฌุงู ูโุดูุฏ. ุจุฑุฎูุงู ุชูฺฉูุฒุฑูุง ูุจู ฺฉู ุงุฒ `<|unk|>` ุจุฑุง ูุงฺูโูุง ูุงุดูุงุฎุชู ุงุณุชูุงุฏู ูโฺฉุฑุฏูุฏุ ุชูฺฉูุฒุฑ BPE **ุจุฏูู ูุงุฒ ุจู ูฺ ุชูฺฉู ูฺูโุงุ ูุงฺูโูุง ูุงุดูุงุฎุชู ุฑุง ุจู ุงุฌุฒุง ฺฉูฺฺฉโุชุฑ (subword ุง ุญุช ฺฉุงุฑุงฺฉุชุฑ) ุชุฌุฒู ูโฺฉูุฏ**.

> **ุดฺฉู ฒ.ฑฑ** ุงู ูุฑุขูุฏ ุฑุง ูุดุงู ูโุฏูุฏ ฺฉู ฺฺฏููู ูุงฺูโูุง ูุงุดูุงุฎุชู ุจู ุฒุฑูุงุญุฏูุง ุชุฌุฒู ูโุดููุฏ ู ุจู ุงู ุชุฑุชุจุ ุชูฺฉูุฒุฑ ูโุชูุงูุฏ ุจุง ูุฑ ูุงฺูโุง (ุญุช ูุงฺูโูุง ุฏุฏูโูุดุฏู) ฺฉุงุฑ ฺฉูุฏ.

---

### ฺฺฏููู BPE ูุงฺูโูุง ูุงุดูุงุฎุชู ุฑุง ูุฏุฑุช ูโฺฉูุฏุ

ุงูฺฏูุฑุชู BPEุ ูุงฺฺฏุงู ุงุฒ ูพุด ุชุนุฑูโุดุฏูโุงุด ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุฑฺฉุจโูุง ูพุฑุชฺฉุฑุงุฑ ฺฉุงุฑุงฺฉุชุฑูุง ู ุฒุฑูุงฺูโูุง ูโุณุงุฒุฏ. ุจูุงุจุฑุงูุ ููฺฏุงู ููุงุฌูู ุจุง ูุงฺูโุง ฺฉู ูุจูุงู ุฏุฑ ูุงฺฺฏุงู ูุจูุฏูุ ูโุชูุงูุฏ ุขู ุฑุง ุจู ุชูฺฉูโูุง ฺฉูฺฺฉโุชุฑ ุดฺฉุณุชู ู ูพุฑุฏุงุฒุด ฺฉูุฏ.

ุจุฑุง ูุซุงู:

- BPE ุงุจุชุฏุง ูููโ ุญุฑูู ุงููุจุง ุฑุง ุจู ุนููุงู ุชูฺฉูโูุง ุงููู ุฏุฑ ูุงฺฺฏุงู ูุฑุงุฑ ูโุฏูุฏ (ูุงููุฏ "a"ุ "b"ุ ...).
- ุณูพุณุ ุชุฑฺฉุจโูุง ุงุฒ ฺฉุงุฑุงฺฉุชุฑูุง ฺฉู **ุจุดุชุฑ ุจุง ูู ุชฺฉุฑุงุฑ ูโุดููุฏ** ุฑุง ุจู ุฒุฑูุงฺูโูุง ุฌุฏุฏ ุชุจุฏู ูโฺฉูุฏ.

ูุซุงู: ุชุฑฺฉุจ "d" ู "e" ููฺฉู ุงุณุช ุจู "de" ุชุจุฏู ุดูุฏุ ฺูู ุฏุฑ ูุงฺฺฏุงู ูุซู "define"ุ "depend"ุ "made" ู "hidden" ูพุฑุชฺฉุฑุงุฑ ุงุณุช.

ุงูฺฏูุฑุชู ุงู ุชุฑฺฉุจโูุง ุฑุง ุจุฑ ุงุณุงุณ **ุขุณุชุงููโ ูุฑุงูุงู (frequency cutoff)** ุงูุชุฎุงุจ ูโฺฉูุฏ.

---

### ุชูุฑู ฒ.ฑ: ุฑูุฒฺฏุฐุงุฑ BPE ูุงฺูโูุง ูุงุดูุงุฎุชู

> ูุงฺูโูุง "Akwirw ier" ุฑุง ุจุง ุชูฺฉูุฒุฑ BPE ุงุฒ ฺฉุชุงุจุฎุงูู `tiktoken` ุฑูุฒฺฏุฐุงุฑ ฺฉูุฏ ู ุขุฏโูุง ุชูฺฉูโูุง ุฑุง ฺุงูพ ฺฉูุฏ. ุณูพุณุ ุจุฑุง ูุฑ ุขุฏ ุชูฺฉูุ ูุชุฏ `decode` ุฑุง ูุฑุงุฎูุงู ฺฉูุฏ ุชุง ูฺฏุงุดุช ุฏูู ุขูโูุง ุฑุง ุจู ูุชู ุจุจูุฏ. ุฏุฑ ููุงุชุ ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุขุง ุจุง ูุชุฏ `decode` ูโุชูุงู ูุชู ุงุตู "Akwirw ier" ุฑุง ุจุงุฒุณุงุฒ ฺฉุฑุฏ ุง ุฎุฑ.

ุงู ุชูุฑู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุฏุฑฺฉ ุนููโุชุฑ ุงุฒ ูุญููโ ุดฺฉุณุชู ูุงฺูโูุง ูุงุดูุงุฎุชู ุฏุฑ BPE ุจู ุฏุณุช ุขูุฑุฏ.

---


## ฒ.ถ ูููููโุจุฑุฏุงุฑ ุฏุงุฏู ุจุง ูพูุฌุฑูโ ูุบุฒุงู (Sliding Window)

ฺฏุงู ุจุนุฏ ุฏุฑ ุณุงุฎุช ุชุนุจูโูุง (embeddings) ุจุฑุง ูุฏู ุฒุจุงู ุจุฒุฑฺฏ (LLM)ุ ุงุฌุงุฏ **ุฌูุชโูุง ูุฑูุฏ-ูุฏู** ุงุณุช ฺฉู ุจุฑุง ุขููุฒุด ูุฏู ูุงุฒู ุงุณุช. ุงู ุฌูุชโูุง ฺฺฏููู ุณุงุฎุชู ูโุดููุฏุ ููุงูุทูุฑ ฺฉู ูพุดโุชุฑ ุขููุฎุชูุ LLMูุง ุจู ุดฺฉู **ูพุดโุจู ฺฉูููโ ุจุนุฏ** ุขููุฒุด ุฏุงุฏู ูโุดููุฏ (ุดฺฉู ฒ.ฑฒ).

---

### ูููููโฺฏุฑ ุฌูุชโูุง ูุฑูุฏ-ูุฏู ุจุง ูพูุฌุฑู ูุบุฒุงู

ฺฉ ุฑูุด ุณุงุฏู ู ุดููุฏ ุจุฑุง ุณุงุฎุช ุงู ุฌูุชโูุงุ ุงุณุชูุงุฏู ุงุฒ ุฏู ูุชุบุฑ ( x ) ู ( y ) ุงุณุช ฺฉู:

- ูุชุบุฑ ( x ) ุดุงูู ุชูฺฉูโูุง ูุฑูุฏ ุงุณุชุ
- ูุชุบุฑ ( y ) ุดุงูู ููุงู ุชูฺฉูโูุง ุงูุง ุจู ุงูุฏุงุฒู ฺฉ ูููุนุช ุจู ุฌูู ุดูุช ุฏุงุฏู ุดุฏู ุงุณุช (ุนู ฺฉููุงุช ุจุนุฏ ฺฉู ุจุงุฏ ูพุดโุจู ุดููุฏ).

---

### ูุซุงู ุนูู ุจุง BPE ุชูฺฉูุฒุฑ ู ูุชู

ูุฑุถ ฺฉูุฏ ฺฉู ูุชู ุฏุงุณุชุงู ฺฉูุชุงู ยซThe Verdictยป ุฑุง ุจุง ุชูฺฉูุฒุฑ BPE ุฑูุฒฺฏุฐุงุฑ ฺฉุฑุฏูโุงู:

```python
with open("the-verdict.txt", "r", encoding="utf-8") as f:
    raw_text = f.read()
enc_text = tokenizer.encode(raw_text)
print(len(enc_text))  # ุฎุฑูุฌ: 5145 (ุชุนุฏุงุฏ ุชูฺฉูโูุง)
```

ุจุฑุง ุณุงุฏูโุณุงุฒุ ตฐ ุชูฺฉู ุงูู ุฑุง ุญุฐู ูโฺฉูู:

```python
enc_sample = enc_text[50:]
```

ูุฑุถ ฺฉูุฏ ุงูุฏุงุฒู ูพูุฌุฑู (context size) ุจุฑุงุจุฑ ด ุงุณุช:

```python
context_size = 4
x = enc_sample[:context_size]          # ุชูฺฉูโูุง ูุฑูุฏ
y = enc_sample[1:context_size+1]       # ุชูฺฉูโูุง ูุฏู (ุดูุช ุงูุชู)
print(f"x: {x}")
print(f"y: {y}")
```

ุฎุฑูุฌ:

```
x: [290, 4920, 2241, 287]
y: [4920, 2241, 287, 257]
```

---

### ุฌูุชโูุง ูุฑูุฏ ู ูุฏู ฺฏุงู ุจู ฺฏุงู

ุจุง ุงูุฒุงุด ุทูู ูุฑูุฏ ุจู ุชุฑุชุจ ฑ ุชุง ( context_size )ุ ุฌูุชโูุง ุฒุฑ ุณุงุฎุชู ูโุดูุฏ:

```python
for i in range(1, context_size + 1):
    context = enc_sample[:i]
    desired = enc_sample[i]
    print(context, "---->", desired)
```

ุฎุฑูุฌ:

```
[290] ----> 4920
[290, 4920] ----> 2241
[290, 4920, 2241] ----> 287
[290, 4920, 2241, 287] ----> 257
```

ุจุฑุง ุฏุฏู ูุชู ุจู ุฌุง ุขุฏโูุง:

```python
for i in range(1, context_size + 1):
    context = enc_sample[:i]
    desired = enc_sample[i]
    print(tokenizer.decode(context), "---->", tokenizer.decode([desired]))
```

ุฎุฑูุฌ:

```
and ----> established
and established ----> himself
and established himself ----> in
and established himself in ----> a
```

---

### ุณุงุฎุช ุฏุงุฏูโูุง ุขููุฒุด ุจู ุตูุฑุช ุฏุณุชูโุง (Batch)

ุจุฑุง ุขููุฒุด ุจููู ูุฏูุ ูุงุฒ ุจู ุณุงุฎุช **ุฏุงุฏูโูุง ุฏุณุชูโุง** ุฏุงุฑู. ุงุฒ PyTorch ู ฺฉูุงุณโูุง Dataset ู DataLoader ุงุณุชูุงุฏู ูโฺฉูู ุชุง ุฏุงุฏูโูุง ุฑุง ุจู ุตูุฑุช ูุฑูุฏ ู ูุฏู ุขูุงุฏู ฺฉูู.

---

### ฺฉูุงุณ Dataset: `GPTDatasetV1`

```python
import torch
from torch.utils.data import Dataset

class GPTDatasetV1(Dataset):
    def __init__(self, txt, tokenizer, max_length, stride):
        self.input_ids = []
        self.target_ids = []
        token_ids = tokenizer.encode(txt)

        # ุณุงุฎุช ุฏุงุฏู ุจุง ูพูุฌุฑู ูุบุฒุงู
        for i in range(0, len(token_ids) - max_length, stride):
            input_chunk = token_ids[i:i + max_length]
            target_chunk = token_ids[i + 1: i + max_length + 1]
            self.input_ids.append(torch.tensor(input_chunk))
            self.target_ids.append(torch.tensor(target_chunk))

    def __len__(self):
        return len(self.input_ids)

    def __getitem__(self, idx):
        return self.input_ids[idx], self.target_ids[idx]
```

---

### ุณุงุฎุช DataLoader

```python
from torch.utils.data import DataLoader
import tiktoken

def create_dataloader_v1(txt, batch_size=4, max_length=256, stride=128,
                         shuffle=True, drop_last=True, num_workers=0):
    tokenizer = tiktoken.get_encoding("gpt2")
    dataset = GPTDatasetV1(txt, tokenizer, max_length, stride)
    dataloader = DataLoader(
        dataset,
        batch_size=batch_size,
        shuffle=shuffle,
        drop_last=drop_last,
        num_workers=num_workers
    )
    return dataloader
```

---

### ุชุณุช ุจุง batch size=1 ู context_size=4

```python
with open("the-verdict.txt", "r", encoding="utf-8") as f:
    raw_text = f.read()

dataloader = create_dataloader_v1(
    raw_text, batch_size=1, max_length=4, stride=1, shuffle=False)

data_iter = iter(dataloader)
first_batch = next(data_iter)
print(first_batch)
```

ุฎุฑูุฌ (ุชูฺฉูโูุง ูุฑูุฏ ู ูุฏู):

```
[tensor([[ 40, 367, 2885, 1464]]), tensor([[ 367, 2885, 1464, 1807]])]
```

- ุชูุฌู ฺฉูุฏ ฺฉู ูุฑ ุฏุณุชู ุดุงูู ุชูฺฉูโูุง ูุฑูุฏ ู ููุงู ุชูฺฉูโูุง ูู ุดูุช ุงูุชู ุจุฑุง ูุฏู ุงุณุช.

---

### ุญุฑฺฉุช ูพูุฌุฑู ุจุง stride=1 (ูุบุฒุด ุจู ุงูุฏุงุฒู ฑ)

```python
second_batch = next(data_iter)
print(second_batch)
```

ุฎุฑูุฌ:

```
[tensor([[ 367, 2885, 1464, 1807]]), tensor([[2885, 1464, 1807, 3619]])]
```

ุจุง ููุงุณู ุฏุณุชู ุงูู ู ุฏูู ูโุจูู ฺฉู ุฏุณุชู ุฏูู ุจู ุงูุฏุงุฒู ฺฉ ุชูฺฉู ูุณุจุช ุจู ุฏุณุชู ุงูู ุจู ุฌูู ูุบุฒุฏู ุงุณุช. ุงู ููุงู ุงุฏู ูพูุฌุฑู ูุบุฒุงู ุงุณุช (ุดฺฉู ฒ.ฑด).

---

### ุฏุณุชูโุจูุฏ ุจุง batch size ุจุฒุฑฺฏโุชุฑ ู stride ุจุฒุฑฺฏโุชุฑ

ูุซูุงู:

```python
dataloader = create_dataloader_v1(
    raw_text, batch_size=8, max_length=4, stride=4, shuffle=False)

data_iter = iter(dataloader)
inputs, targets = next(data_iter)

print("Inputs:\n", inputs)
print("\nTargets:\n", targets)
```

ุฎุฑูุฌ (ููุงุด ุจุฎุด ุงุฒ ูุฑูุฏ ู ูุฏู):

```
Inputs:
tensor([[ 40, 367, 2885, 1464],
        [1807, 3619, 402, 271],
        ... ])

Targets:
tensor([[ 367, 2885, 1464, 1807],
        [3619, 402, 271, 10899],
        ... ])
```

ููุช stride ุจุฑุงุจุฑ ุจุง ุงูุฏุงุฒู ูพูุฌุฑู ุจุงุดุฏุ ุฏุณุชูโูุง ุฑู ูู ููโุงูุชูุฏ ู ุงุฒ ููู ุฏุงุฏูโูุง ุจุฏูู ุชฺฉุฑุงุฑ ุงุณุชูุงุฏู ูโุดูุฏ.

---

### ูฺฉุงุช ุชฺฉูู:

- ูุชุบุฑโูุง **batch size** ู **stride** ุงุฒ ูุงูพุฑูพุงุฑุงูุชุฑูุง ููู ูุณุชูุฏ ฺฉู ุฑู ฺฉูุช ู ฺฉุงุฑุง ุขููุฒุด ุชุงุซุฑ ูโฺฏุฐุงุฑูุฏ.
- ุงูุชุฎุงุจ stride ฺฉูฺฺฉุชุฑ ุงุฒ max_length ุจุงุนุซ ูููพูุดุงู ุฏุณุชูโูุง ู ูุฏู ุฑุง ุฏุฑ ูุนุฑุถ ุชูฺฉูโูุง ูุดุงุจู ูุฑุงุฑ ูโุฏูุฏ (ููฺฉู ุงุณุช ุจุงุนุซ overfitting ุดูุฏ).
- ุงูุชุฎุงุจ stride ูุณุงู max_length ุจุงุนุซ ุนุฏู ูููพูุดุงู ุฏุณุชูโูุง ูโุดูุฏ.

---

### ุชูุฑู ฒ.ฒ

ุจุฑุง ุฏุฑฺฉ ุจูุชุฑุ ุฏุชุงููุฏุฑ ุฑุง ุจุง ุชูุธูุงุช ูุฎุชูู ุงูุชุญุงู ฺฉูุฏุ ูุซู:

- `max_length=2, stride=2`
- `max_length=8, stride=2`

ู ุชุงุซุฑ ุขู ุฑู ูููููโูุง ูุฑูุฏ ู ูุฏู ุฑุง ุจุฑุฑุณ ฺฉูุฏ.

---

## ฒ.ท ุงุฌุงุฏ ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ (ุชูฺฉู ุงูุจุฏูฺฏโูุง)

ุขุฎุฑู ูุฑุญูู ุฏุฑ ุขูุงุฏูโุณุงุฒ ูุชู ูุฑูุฏ ุจุฑุง ุขููุฒุด ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM) ุชุจุฏู ุดูุงุณูโูุง ุชูฺฉู ุจู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุง **embedding vectors** ุงุณุชุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ุดฺฉู ฒ.ฑต ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช. ุฏุฑ ุงุจุชุฏุง ุจุงุฏ ูุฒูโูุง ุงู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุฑุง ุจุง ููุงุฏุฑ ุชุตุงุฏู ููุฏุงุฑุฏู ุงููู ฺฉูู. ุงู ููุฏุงุฑุฏู ุงููู ููุทู ุดุฑูุน ูุฑุงูุฏ ุงุฏฺฏุฑ ูุฏู ุฒุจุงู ุจุฒุฑฺฏ ุงุณุช. ุฏุฑ ูุตู ตุ ูุฒูโูุง ุงู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุฏุฑ ุทูู ุขููุฒุด ูุฏู ุจููู ุฎูุงููุฏ ุดุฏ.

ุดฺฉู ฒ.ฑต ูุดุงู ูโุฏูุฏ ฺฉู ุขูุงุฏูโุณุงุฒ ุดุงูู ุณู ูุฑุญูู ุงุตู ุงุณุช: ุชูฺฉูโุณุงุฒ ูุชูุ ุชุจุฏู ุชูฺฉูโูุง ุจู ุดูุงุณูโูุง ุชูฺฉู ู ุฏุฑ ููุงุช ุชุจุฏู ุดูุงุณูโูุง ุชูฺฉู ุจู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ. ุฏุฑ ุงูุฌุง ูุฑุถ ูโฺฉูู ุดูุงุณูโูุง ุชูฺฉู ุงุฒ ูุจู ุงุฌุงุฏ ุดุฏูโุงูุฏ ู ุญุงู ูโุฎูุงูู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ูุชูุงุธุฑ ุจุง ุขูโูุง ุฑุง ุจุณุงุฒู.

ฺฉ ููุงุด ุจุฑุฏุงุฑ ูพูุณุชู ุง ููุงู ุฌุงุณุงุฒุ ุถุฑูุฑ ุงุณุช ุฒุฑุง ูุฏูโูุง ูุดุงุจู GPT ุดุจฺฉูโูุง ุนุตุจ ุนูู ูุณุชูุฏ ฺฉู ุจุง ุงูฺฏูุฑุชู ูพุณโุงูุชุดุงุฑ ุฎุทุง (backpropagation) ุขููุฒุด ุฏุงุฏู ูโุดููุฏ.
**ุชูุฌู:** ุงฺฏุฑ ุจุง ูุญูู ุขููุฒุด ุดุจฺฉูโูุง ุนุตุจ ุจุง ุงูฺฏูุฑุชู ูพุณโุงูุชุดุงุฑ ุขุดูุง ูุฏุงุฑุฏุ ุจุฎุด B.4 ุฏุฑ ุถููู A ุฑุง ูุทุงูุนู ฺฉูุฏ.

ุญุงูุง ุจุง ฺฉ ูุซุงู ุนูู ูุญูู ุชุจุฏู ุดูุงุณู ุชูฺฉู ุจู ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ุฑุง ุจุจูู. ูุฑุถ ฺฉูู ฺูุงุฑ ุชูฺฉู ูุฑูุฏ ุจุง ุดูุงุณูโูุง ฒุ ณุ ต ู ฑ ุฏุงุฑู:

```python
input_ids = torch.tensor([2, 3, 5, 1])
```

ุจุฑุง ุณุงุฏฺฏ ูุฑุถ ฺฉูู ุฏฺฉุดูุฑ ูุง ููุท ถ ฺฉููู ุฏุงุฑุฏ (ุฏุฑ ููุงุจู ตฐ,ฒตท ฺฉููู ุฏุฑ ุฏฺฉุดูุฑ BPE ุชูฺฉูุงุฒุฑ ูุงูุน) ู ูโุฎูุงูู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุณูโุจุนุฏ ุจุณุงุฒู (ุฏุฑ GPT-3 ุงูุฏุงุฒู ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ฑฒฒธธ ุจุนุฏ ุงุณุช):

```python
vocab_size = 6
output_dim = 3
```

ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูุฏุงุฒู ุฏฺฉุดูุฑ ู ุจุนุฏ ุฎุฑูุฌุ ูุงู ุฌุงุณุงุฒ ุฏุฑ PyTorch ุฑุง ุงุฌุงุฏ ูโฺฉูู ู ุจุฑุง ุชฺฉุฑุงุฑูพุฐุฑุ ููุฏุงุฑ seed ุฑุง ุฑู ฑฒณ ุชูุธู ูโฺฉูู:

```python
torch.manual_seed(123)
embedding_layer = torch.nn.Embedding(vocab_size, output_dim)
print(embedding_layer.weight)
```

ุฎุฑูุฌ ุงู ุฏุณุชูุฑุ ูุงุชุฑุณ ูุฒูโูุง ุฒุฑุณุงุฎุช ูุงู ุฌุงุณุงุฒ ุฑุง ูุดุงู ูโุฏูุฏ:

```
Parameter containing:
tensor([[ 0.3374, -0.1778, -0.1690],
        [ 0.9178, 1.5810, 1.3010],
        [ 1.2753, -0.2010, -0.1606],
        [-0.4015, 0.9666, -1.1481],
        [-1.1589, 0.3255, -0.6315],
        [-2.8400, -0.7849, -1.4096]], requires_grad=True)
```

ูุงุชุฑุณ ูุฒู ูุงู ุฌุงุณุงุฒ ุดุงูู ููุงุฏุฑ ฺฉูฺฺฉ ู ุชุตุงุฏู ุงุณุช ฺฉู ุฏุฑ ุทูู ุขููุฒุด ูุฏู ุจููู ูโุดููุฏ. ุงู ูุงุชุฑุณ ถ ุณุทุฑ ู ณ ุณุชูู ุฏุงุฑุฏุ ูุฑ ุณุทุฑ ูุชูุงุธุฑ ุจุง ฺฉ ุงุฒ ถ ุชูฺฉู ููุฌูุฏ ุฏุฑ ุฏฺฉุดูุฑ ู ูุฑ ุณุชูู ูุชูุงุธุฑ ุจุง ฺฉ ุงุฒ ณ ุจุนุฏ ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ุงุณุช.

ุญุงูุง ุจุงุฏ ุงู ูุงู ุฑุง ุจุฑุง ฺฉ ุดูุงุณู ุชูฺฉู ุจู ฺฉุงุฑ ุจุจุฑู ุชุง ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ุขู ุฑุง ุจู ุฏุณุช ุขูุฑู:

```python
print(embedding_layer(torch.tensor([3])))
```

ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ุจุงุฒฺฏุฑุฏุงูุฏู ุดุฏู ุจู ุตูุฑุช ุฒุฑ ุงุณุช:

```
tensor([[-0.4015, 0.9666, -1.1481]], grad_fn=<EmbeddingBackward0>)
```

ุงฺฏุฑ ุงู ุจุฑุฏุงุฑ ุฑุง ุจุง ุฑุฏู ฺูุงุฑู ูุงุชุฑุณ ูุฒู ููุงุณู ฺฉูู (ฺูู ุงูุฏุณโูุง ุงุฒ ุตูุฑ ุดุฑูุน ูโุดููุฏุ ุฑุฏู ุจุง ุงูุฏุณ ณ)ุ ูุดุงูุฏู ูโฺฉูู ฺฉู ุฏููุงู ููุงู ุงุณุช. ุจู ุนุจุงุฑุช ุฏฺฏุฑุ ูุงู ุฌุงุณุงุฒ ุฏุฑ ูุงูุน ฺฉ ุนููุงุช ุฌุณุชุฌู (lookup) ุงุณุช ฺฉู ุฑุฏูโูุง ูุงุชุฑุณ ูุฒู ุฑุง ุจุฑ ุงุณุงุณ ุดูุงุณู ุชูฺฉู ุงุณุชุฎุฑุงุฌ ูโฺฉูุฏ.

**ุชูุฌู:** ุจุฑุง ฺฉุณุงู ฺฉู ุจุง ุฑูุฒฺฏุฐุงุฑ one-hot ุขุดูุง ูุณุชูุฏุ ุฑูุด ูุงู ุฌุงุณุงุฒ ุงูุฌุง ุตุฑูุงู ฺฉ ูพุงุฏูโุณุงุฒ ุจูููโุชุฑ ุงุฒ ุฑูุฒฺฏุฐุงุฑ one-hot ุจู ููุฑุงู ุถุฑุจ ูุงุชุฑุณ ุฏุฑ ูุงู ฺฉุงููุงู ูุชุตู ุงุณุช. ุงู ููุถูุน ุฏุฑ ฺฉุฏูุง ูฺฉูู ููุฌูุฏ ุฏุฑ ฺฏุชโูุงุจ ุฏุฑ ุขุฏุฑุณ [https://mng.bz/ZEB5](https://mng.bz/ZEB5) ุชูุถุญ ุฏุงุฏู ุดุฏู ุงุณุช. ุจู ููู ุฏูู ูุงู ุฌุงุณุงุฒ ุจู ุนููุงู ฺฉ ูุงู ุดุจฺฉู ุนุตุจ ูุญุณูุจ ูโุดูุฏ ฺฉู ูโุชูุงู ุขู ุฑุง ุจุง ูพุณโุงูุชุดุงุฑ ุจููู ฺฉุฑุฏ.

ุชุง ุงูุฌุง ุฏุฏู ฺฺฏููู ฺฉ ุดูุงุณู ุชูฺฉู ุฑุง ุจู ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ุณูโุจุนุฏ ุชุจุฏู ฺฉูู. ุญุงูุง ุงู ฺฉุงุฑ ุฑุง ุจุฑุง ูุฑ ฺูุงุฑ ุดูุงุณู ูุฑูุฏ ุงุนูุงู ูโฺฉูู:

```python
print(embedding_layer(input_ids))
```

ุฎุฑูุฌ ฺฉ ูุงุชุฑุณ ด ุฏุฑ ณ ุฎูุงูุฏ ุจูุฏ:

```
tensor([[ 1.2753, -0.2010, -0.1606],
        [-0.4015, 0.9666, -1.1481],
        [-2.8400, -0.7849, -1.4096],
        [ 0.9178, 1.5810, 1.3010]], grad_fn=<EmbeddingBackward0>)
```

ูุฑ ุฑุฏู ุงู ูุงุชุฑุณุ ุงุฒ ุทุฑู ุนููุงุช ุฌุณุชุฌู ุงุฒ ูุงุชุฑุณ ูุฒู ูุงู ุฌุงุณุงุฒ ุงุณุชุฎุฑุงุฌ ุดุฏู ุงุณุชุ ููุงูุทูุฑ ฺฉู ุฏุฑ ุดฺฉู ฒ.ฑถ ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช.

ุงฺฉููู ฺฉู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ูุชูุงุธุฑ ุจุง ุดูุงุณูโูุง ุชูฺฉู ุฑุง ุงุฌุงุฏ ฺฉุฑุฏูโุงูุ ุฏุฑ ุงุฏุงูู ฺฉู ุงู ุจุฑุฏุงุฑูุง ุฑุง ุชุบุฑ ูโุฏูู ุชุง ุงุทูุงุนุงุช ูููุนุช ูุฑ ุชูฺฉู ุฏุฑ ูุชู ุฑุง ูุฒ ุฏุฑ ุขููุง ุจฺฏูุฌุงูู.

## ฒ.ธ ุฑูุฒฺฏุฐุงุฑ ูููุนุช ฺฉููุงุช

ุฏุฑ ุงุตูุ ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุชูฺฉูโูุง (token embeddings) ูุฑูุฏ ููุงุณุจ ุจุฑุง ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM) ูุณุชูุฏ. ุจุง ุงู ุญุงูุ ฺฉ ูฺฉุชู ฺฉูฺฺฉ ูุฌูุฏ ุฏุงุฑุฏ: ูฺฉุงูุฒู ุชูุฌู ุฎูุฏ (self-attention) ุฏุฑ ุงู ูุฏูโูุงุ ฺฉู ุฏุฑ ูุตู ณ ุชูุถุญ ุฏุงุฏู ุดุฏูุ ูููุนุช ุง ุชุฑุชุจ ุชูฺฉูโูุง ุฑุง ุฏุฑูู ุชูุงู ุฏุฑ ูุธุฑ ููโฺฏุฑุฏ. ุจู ููู ุฏููุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ุดฺฉู ฒ.ฑท ูุดุงูุฏู ูโฺฉูุฏุ ูุงู ุฌุงุณุงุฒุ ูุฑ ุดูุงุณู ุชูฺฉู (token ID) ุฑุง ุจู ฺฉ ุจุฑุฏุงุฑ ุซุงุจุช ุชุจุฏู ูโฺฉูุฏุ ุจุฏูู ุชูุฌู ุจู ุฌุงฺฏุงู ุขู ุชูฺฉู ุฏุฑ ุชูุงู ูุฑูุฏ.

ุฏุฑ ุดฺฉู ฒ.ฑถ ูุฒ ุฏุฏู ูโุดูุฏ ฺฉู ูุงู ุฌุงุณุงุฒ ฺฉ ุนููุงุช ุฌุณุชุฌู ุงุณุช ฺฉู ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ูุชูุงุธุฑ ุจุง ุดูุงุณู ุชูฺฉู ุฑุง ุงุฒ ูุงุชุฑุณ ูุฒู ูุงู ุจุงุฒุงุจ ูโฺฉูุฏ. ุจุฑุง ูุซุงูุ ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ุดูุงุณู ุชูฺฉู ตุ ุฑุฏู ุดุดู ูุงุชุฑุณ ูุฒู ุงุณุช (ฺูู ุงูุฏุณโุดูุงุฑ ุงุฒ ุตูุฑ ุดุฑูุน ูโุดูุฏ).

ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ูุณุชูู ุงุฒ ูููุนุชุ ุงุฒ ูุธุฑ ูุงุจูุช ุชฺฉุฑุงุฑ (reproducibility) ููุฏ ูุณุชูุฏ. ุงูุง ุงุฒ ุขูุฌุง ฺฉู ูฺฉุงูุฒู ุชูุฌู ุฎูุฏ ูุฒ ุจู ูููุนุช ุญุณุงุณ ูุณุชุ ุงุถุงูู ฺฉุฑุฏู ุงุทูุงุนุงุช ูููุนุช ุจู ูุฏู ุจุณุงุฑ ฺฉูฺฉโฺฉููุฏู ุงุณุช.

ุจุฑุง ุงู ููุธูุฑ ุฏู ููุน ุงุตู ุฌุงุณุงุฒ ูููุนุช ูุฌูุฏ ุฏุงุฑุฏ:

- **ุฌุงุณุงุฒ ูููุนุช ูุทูู (Absolute Positional Embeddings):** ฺฉู ุจู ูุฑ ูููุนุช ูุดุฎุต ุฏุฑ ุชูุงู ฺฉ ุจุฑุฏุงุฑ ูููุนุช ฺฉุชุง ุงุฎุชุตุงุต ูโุฏูุฏ ู ุงู ุจุฑุฏุงุฑ ุจู ุจุฑุฏุงุฑ ุฌุงุณุงุฒ ุชูฺฉู ุงูุฒูุฏู ูโุดูุฏ. ูุซูุง ุชูฺฉู ุงูู ฺฉ ุจุฑุฏุงุฑ ูููุนุช ูุฎุตูุต ุฎูุฏ ุฑุง ุฏุงุฑุฏุ ุชูฺฉู ุฏูู ุจุฑุฏุงุฑ ุฏฺฏุฑ ู ...ุ ููุงูโุทูุฑ ฺฉู ุฏุฑ ุดฺฉู ฒ.ฑธ ูุดุงู ุฏุงุฏู ุดุฏู ุงุณุช.
- **ุฌุงุณุงุฒ ูููุนุช ูุณุจ (Relative Positional Embeddings):** ุฏุฑ ุงู ููุนุ ุชูุฑฺฉุฒ ุฑู ูุงุตูู ุง ูููุนุช ูุณุจ ุจู ุชูฺฉูโูุงุณุชุ ูู ูููุนุช ูุทูู ุขูโูุง. ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ูุฏู ุจูุชุฑ ุจุชูุงูุฏ ุชูุงูโูุง ุจุง ุทููโูุง ูุชูุงูุช ุฑุง ุชุนูู ุฏูุฏ ุญุช ุงฺฏุฑ ุฏุฑ ุทูู ุขููุฒุด ฺูู ุชูุงูโูุง ุฑุง ูุฏุฏู ุจุงุดุฏ.

ูุฏู ูุฑ ุฏู ููุน ุฌุงุณุงุฒ ูููุนุชุ ุงูุฒุงุด ุชูุงูุง ูุฏู ุฏุฑ ุฏุฑฺฉ ุชุฑุชุจ ู ุฑูุงุจุท ุจู ุชูฺฉูโูุง ุงุณุช ุชุง ูพุดโุจูโูุง ุฏููโุชุฑ ู ูุชูโุชุฑ ุงุฑุงุฆู ุดูุฏ. ุงูุชุฎุงุจ ุจู ุงู ุฏู ูุนูููุงู ุจู ฺฉุงุฑุจุฑุฏ ู ููุน ุฏุงุฏูโูุง ุจุณุชฺฏ ุฏุงุฑุฏ.

ูุฏูโูุง GPT ุดุฑฺฉุช OpenAI ุงุฒ ุฌุงุณุงุฒ ูููุนุช ูุทูู ุงุณุชูุงุฏู ูโฺฉููุฏ ฺฉู ุฏุฑ ุทูู ุขููุฒุด ูุฏู ุจููู ูโุดูุฏ ู ุซุงุจุช ุง ุงุฒ ูพุด ุชุนุฑูโุดุฏู ูุณุชุ ุจุฑุฎูุงู ุฑูุฒฺฏุฐุงุฑ ูููุนุช ุฏุฑ ูุฏู ุชุฑูุณููุฑูุฑ ุงุตู.

---

ุญุงูุง ูโุฎูุงูู ุฌุงุณุงุฒ ูููุนุช ุงููู ุฑุง ุจุฑุง ุขูุงุฏูโุณุงุฒ ูุฑูุฏโูุง LLM ุจุณุงุฒู.

ูุจูุงู ุจุฑุง ุณุงุฏฺฏุ ุงูุฏุงุฒู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุฑุง ุฎู ฺฉูฺฺฉ ุฏุฑ ูุธุฑ ฺฏุฑูุชู. ุญุงูุง ุงูุฏุงุฒูโูุง ูุงูุนโุชุฑ ู ฺฉุงุฑุจุฑุฏโุชุฑ ุฑุง ูุฏ ูุธุฑ ูุฑุงุฑ ูโุฏูู ู ุชูฺฉูโูุง ุฑุง ุจู ุจุฑุฏุงุฑูุง ฒตถ ุจุนุฏ ุชุจุฏู ูโฺฉูู. ุงู ุงูุฏุงุฒู ฺฉูุชุฑ ุงุฒ ููุฏุงุฑ ุงุณุชูุงุฏู ุดุฏู ุฏุฑ GPT-3 (ฑฒฒธธ ุจุนุฏ) ุงุณุชุ ุงูุง ุจุฑุง ุขุฒูุงุด ููุงุณุจ ุงุณุช. ููฺูู ูุฑุถ ูโฺฉูู ุดูุงุณูโูุง ุชูฺฉู ุงุฒ ุชูฺฉูุงุฒุฑ BPE ุจุง ุฏฺฉุดูุฑ ตฐ,ฒตท ฺฉูููโุง ฺฉู ูุจูุงู ูพุงุฏูโุณุงุฒ ฺฉุฑุฏูุ ุจู ุฏุณุช ุขูุฏูโุงูุฏ:

```python
vocab_size = 50257
output_dim = 256
token_embedding_layer = torch.nn.Embedding(vocab_size, output_dim)
```

ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ูุงู ุฌุงุณุงุฒุ ุงฺฏุฑ ุฏุงุฏูโุง ุฑุง ุงุฒ ุฏุงุฏูโุฎูุงู (data loader) ูููููโุจุฑุฏุงุฑ ฺฉููุ ูุฑ ุชูฺฉู ุฏุฑ ูุฑ ุฏุณุชู (batch) ุจู ุจุฑุฏุงุฑ ฒตถ ุจุนุฏ ุชุจุฏู ูโุดูุฏ. ุงฺฏุฑ ุงูุฏุงุฒู ุฏุณุชู ธ ู ุชุนุฏุงุฏ ุชูฺฉูโูุง ุฏุฑ ูุฑ ููููู ด ุจุงุดุฏุ ุฎุฑูุฌ ฺฉ ุชูุณูุฑ ธ ร ด ร ฒตถ ุฎูุงูุฏ ุจูุฏ.

ุงุจุชุฏุง ุฏุงุฏูโุฎูุงู ุฑุง ุงุฌุงุฏ ูโฺฉูู (ุจุฎุด ฒ.ถ):

```python
max_length = 4
dataloader = create_dataloader_v1(
    raw_text, batch_size=8, max_length=max_length,
    stride=max_length, shuffle=False
)
data_iter = iter(dataloader)
inputs, targets = next(data_iter)
print("Token IDs:\n", inputs)
print("\nInputs shape:\n", inputs.shape)
```

ุฎุฑูุฌ ุจู ุตูุฑุช ุฒุฑ ุฎูุงูุฏ ุจูุฏ:

```
Token IDs:
tensor([[ 40, 367, 2885, 1464],
        [1807, 3619, 402, 271],
        [10899, 2138, 257, 7026],
        [15632, 438, 2016, 257],
        [922, 5891, 1576, 438],
        [568, 340, 373, 645],
        [1049, 5975, 284, 502],
        [284, 3285, 326, 11]])
Inputs shape:
torch.Size([8, 4])
```

ููุงูุทูุฑ ฺฉู ูโุจููุ ุชูุณูุฑ ุดูุงุณูโูุง ุชูฺฉู ธ ร ด ุงุณุชุ ุนู ูุฑ ุฏุณุชู ุดุงูู ูุดุช ููููู ูุชู ุจุง ฺูุงุฑ ุชูฺฉู ูุฑ ฺฉุฏุงู ุงุณุช.

ุญุงูุง ุดูุงุณูโูุง ุชูฺฉู ุฑุง ุจุง ูุงู ุฌุงุณุงุฒ ุจู ุจุฑุฏุงุฑูุง ฒตถ ุจุนุฏ ุชุจุฏู ูโฺฉูู:

```python
token_embeddings = token_embedding_layer(inputs)
print(token_embeddings.shape)
```

ุฎุฑูุฌ:

```
torch.Size([8, 4, 256])
```

ุงู ุชูุณูุฑ ูุดุงู ูโุฏูุฏ ฺฉู ูุฑ ุดูุงุณู ุชูฺฉู ุจู ุจุฑุฏุงุฑ ฒตถ ุจุนุฏ ุชุจุฏู ุดุฏู ุงุณุช.

---

ุจุฑุง ุฑูุด ุฌุงุณุงุฒ ูููุนุช ูุทูู ุฏุฑ GPTุ ุจุงุฏ ฺฉ ูุงู ุฌุงุณุงุฒ ูููุนุช ุฏฺฏุฑ ุจุง ููุงู ุงุจุนุงุฏ ุฌุงุณุงุฒ ุชูฺฉูโูุง ุงุฌุงุฏ ฺฉูู:

```python
context_length = max_length
pos_embedding_layer = torch.nn.Embedding(context_length, output_dim)
pos_embeddings = pos_embedding_layer(torch.arange(context_length))
print(pos_embeddings.shape)
```

ูุฑูุฏ ุงู ูุงู ูุนูููุงู ฺฉ ุจุฑุฏุงุฑ ุชุฑุชุจโุดูุงุฑ ุงุณุช:

```python
torch.arange(context_length)
```

ฺฉู ุดุงูู ุงุนุฏุงุฏ ฐุ ฑุ ... ุชุง ุทูู ุจุดูู ูุฑูุฏ ูููุง ฺฉ ุงุณุช. ูุชุบุฑ context_length ููุงุงูฺฏุฑ ุจุดูู ุทูู ูุฑูุฏ ูพุดุชุจุงู ุดุฏู ุชูุณุท LLM ุงุณุช. ุฏุฑ ุงูุฌุง ุขู ุฑุง ุจุฑุงุจุฑ ุจุง ุจุดูู ุทูู ูุฑูุฏ ูุชู ูุฑุงุฑ ุฏุงุฏูโุงู. ุฏุฑ ุนููุ ุงฺฏุฑ ูุชู ูุฑูุฏ ุทููุงูโุชุฑ ุจุงุดุฏุ ุจุงุฏ ุขู ุฑุง ฺฉูุชุงู ฺฉูู (truncate).

ุฎุฑูุฌ:

```
torch.Size([4, 256])
```

ูพุณ ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ูููุนุชุ ุดุงูู ฺูุงุฑ ุจุฑุฏุงุฑ ฒตถ ุจุนุฏ ูุณุชูุฏ.

ุญุงูุง ุงู ุจุฑุฏุงุฑูุง ูููุนุช ุฑุง ูุณุชููุงู ุจู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุชูฺฉู ุงุถุงูู ูโฺฉูู. ุฏุฑ PyTorchุ ุงู ุนูู ุจุฑุง ูุฑ ธ ุฏุณุชู ุจู ุตูุฑุช ููุฒูุงู ุงูุฌุงู ูโุดูุฏ:

```python
input_embeddings = token_embeddings + pos_embeddings
print(input_embeddings.shape)
```

ุฎุฑูุฌ:

```
torch.Size([8, 4, 256])
```

ุจุฑุฏุงุฑูุง **input_embeddings** ฺฉู ุจู ุตูุฑุช ุฎูุงุตู ุฏุฑ ุดฺฉู ฒ.ฑน ููุงุด ุฏุงุฏู ุดุฏูโุงูุฏุ ูุฑูุฏโูุง ุฌุงุณุงุฒ ุดุฏูโุง ูุณุชูุฏ ฺฉู ุงฺฉููู ุขูุงุฏู ูพุฑุฏุงุฒุด ุชูุณุท ูุงฺููโูุง ุงุตู ูุฏู ุฒุจุงู ุจุฒุฑฺฏ ูุณุชูุฏุ ฺฉู ุฏุฑ ูุตู ุจุนุฏ ูพุงุฏูโุณุงุฒ ุฎูุงูู ฺฉุฑุฏ.

---

**ุฎูุงุตู ูุฑุขูุฏ ุฏุฑ ุดฺฉู ฒ.ฑน:**
ูุชู ูุฑูุฏ ุงุจุชุฏุง ุจู ุชูฺฉูโูุง ุฌุฏุงฺฏุงูู ุชูุณู ูโุดูุฏุ ุณูพุณ ุงู ุชูฺฉูโูุง ุจู ุดูุงุณูโูุง ุนุฏุฏ ุชุจุฏู ูโุดููุฏุ ุดูุงุณูโูุง ุจู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุดุฏู (embedding vectors) ุชุจุฏู ูโุดููุฏ ู ุฏุฑ ููุงุช ุจุฑุฏุงุฑูุง ูููุนุช ุจุง ุงุจุนุงุฏ ูุดุงุจู ุจู ุจุฑุฏุงุฑูุง ุชูฺฉู ุงูุฒูุฏู ูโุดููุฏ ุชุง ูุฑูุฏ ููุง ูุฏู ุณุงุฎุชู ุดูุฏ.

## ุฎูุงุตู

- ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ (LLM) ุจุฑุง ูพุฑุฏุงุฒุด ูุชู ุฎุงู ูุงุฒ ุฏุงุฑูุฏ ฺฉู ุฏุงุฏูโูุง ูุชู ุจู ุจุฑุฏุงุฑูุง ุนุฏุฏ ุชุจุฏู ุดููุฏ ฺฉู ุจู ุขูโูุง ยซุฌุงุณุงุฒยป (embedding) ฺฏูุชู ูโุดูุฏ. ุงู ุจุฑุฏุงุฑูุง ุฏุงุฏูโูุง ฺฏุณุณุชู ูุงููุฏ ฺฉููุงุช ุง ุชุตุงูุฑ ุฑุง ุจู ูุถุง ุจุฑุฏุงุฑ ูพูุณุชู ุชุจุฏู ูโฺฉููุฏ ุชุง ุจุชูุงู ุขูโูุง ุฑุง ุจุง ุนููุงุช ุดุจฺฉูโูุง ุนุตุจ ุณุงุฒฺฏุงุฑ ฺฉุฑุฏ.

- ุฏุฑ ฺฏุงู ุงููุ ูุชู ุฎุงู ุจู ุชูฺฉูโูุง ุชูุณู ูโุดูุฏ ฺฉู ูโุชูุงููุฏ ฺฉููุงุช ุง ุญุฑูู ุจุงุดูุฏ. ุณูพุณ ุงู ุชูฺฉูโูุง ุจู ุงุนุฏุงุฏ ุตุญุญ ุชุจุฏู ูโุดููุฏ ฺฉู ุจู ุขูโูุง ุดูุงุณู ุชูฺฉู (token ID) ฺฏูุชู ูโุดูุฏ.

- ุชูฺฉูโูุง ูฺูโุง ูุงููุฏ `<|unk|>` (ุจุฑุง ฺฉููุงุช ูุงุดูุงุฎุชู) ู `<|endoftext|>` (ุจุฑุง ุนูุงูุชโฺฏุฐุงุฑ ูพุงุงู ูุชู) ูโุชูุงููุฏ ุจู ูุฏู ุงุถุงูู ุดููุฏ ุชุง ุฏุฑฺฉ ุขู ุจูุชุฑ ุดุฏู ู ุจุชูุงูุฏ ูููุนุชโูุง ูุฎุชูู ูุงููุฏ ฺฉููุงุช ูุงุดูุงุฎุชู ุง ูุฑุฒูุง ุจู ูุชูู ูุงูุฑุชุจุท ุฑุง ูุฏุฑุช ฺฉูุฏ.

- ุดฺฉู ฒ.ฑน ุฑููุฏ ฺฉู ูพุฑุฏุงุฒุด ูุฑูุฏ ุฑุง ูุดุงู ูโุฏูุฏ: ุงุจุชุฏุง ูุชู ูุฑูุฏ ุจู ุชูฺฉูโูุง ุฌุฏุงฺฏุงูู ุชูุณู ูโุดูุฏุ ุณูพุณ ุงู ุชูฺฉูโูุง ุจู ุดูุงุณูโูุง ุนุฏุฏ ุชุจุฏู ูโุดููุฏุ ุจุนุฏ ุดูุงุณูโูุง ุจู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุชุจุฏู ูโุดููุฏ ู ุฏุฑ ููุงุช ุจุฑุฏุงุฑูุง ูููุนุช ุจุง ุงุจุนุงุฏ ูุดุงุจู ุจู ุขูโูุง ุงูุฒูุฏู ูโุดููุฏ ุชุง ูุฑูุฏ ููุง ูุฏู ุณุงุฎุชู ุดูุฏ.

- ุชูฺฉูุงุฒุฑ ุจุงุชโุฒูุฌ (BPE) ฺฉู ุฏุฑ ูุฏูโูุง GPT-2 ู GPT-3 ุงุณุชูุงุฏู ูโุดูุฏุ ุจู ุทูุฑ ูุคุซุฑ ฺฉููุงุช ูุงุดูุงุฎุชู ุฑุง ุจุง ุดฺฉุณุชู ุขูโูุง ุจู ุฒุฑูุงุญุฏูุง ฺฉููู ุง ุญุฑูู ุฌุฏุงฺฏุงูู ูุฏุฑุช ูโฺฉูุฏ.

ุจุฑุง ุขููุฒุด LLMูุงุ ุงุฒ ุฑูุด ูพูุฌุฑู ูุบุฒุงู ุฑู ุฏุงุฏูโูุง ุชูฺฉูุฒู ุดุฏู ุงุณุชูุงุฏู ูโฺฉูู ุชุง ุฌูุชโูุง ูุฑูุฏ-ูุฏู ุชููุฏ ุดูุฏ.

- ูุงูโูุง ุฌุงุณุงุฒ ุฏุฑ PyTorch ุจู ุดฺฉู ฺฉ ุนููุงุช ุฌุณุชุฌู ุนูู ูโฺฉููุฏ ู ุจุฑุฏุงุฑูุง ูุฑุจูุท ุจู ุดูุงุณูโูุง ุชูฺฉู ุฑุง ุจุงุฒุงุจ ูโฺฉููุฏ. ุงู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ููุงูุฏฺฏโูุง ูพูุณุชูโุง ุงุฒ ุชูฺฉูโูุง ุงุฑุงุฆู ูโุฏููุฏ ฺฉู ุจุฑุง ุขููุฒุด ูุฏูโูุง ุนูู ูุงููุฏ LLMูุง ุจุณุงุฑ ุญุงุช ุงุณุช.

- ุงฺฏุฑฺู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุชูฺฉู ููุงูุฏฺฏโูุง ุซุงุจุช ุจุฑุง ูุฑ ุชูฺฉู ูุฑุงูู ูโฺฉููุฏุ ุงูุง ุงุทูุงุนุงุช ุฏุฑุจุงุฑู ูููุนุช ุชูฺฉู ุฏุฑ ุชูุงู ูุฏุงุฑูุฏ. ุจุฑุง ุฑูุน ุงู ูุดฺฉูุ ุฏู ููุน ุงุตู ุจุฑุฏุงุฑ ูููุนุช ูุฌูุฏ ุฏุงุฑุฏ: ูููุนุช ูุทูู ู ูููุนุช ูุณุจ. ูุฏูโูุง GPT ุดุฑฺฉุช OpenAI ุงุฒ ุฌุงุณุงุฒ ูููุนุช ูุทูู ุงุณุชูุงุฏู ูโฺฉููุฏ ฺฉู ุจู ุจุฑุฏุงุฑูุง ุฌุงุณุงุฒ ุชูฺฉู ุงุถุงูู ุดุฏู ู ุฏุฑ ุทูู ุขููุฒุด ูุฏู ุจููู ูโุดููุฏ.
---

> [ 1.ุฏุฑฺฉ ูุฏูโูุง ุฒุจุงู ุจุฒุฑฺฏ
     (ูุจู) ](<01.Understanding large language models.md>) < 2.ฺฉุงุฑ ุจุง ุฏุงุฏูโูุง ูุชู > 
[
    3.ฺฉุฏููุณ ูฺฉุงูุฒูโูุง ุชูุฌู
(ุจุนุฏ)
](<03.Coding attention mechanisms.md>)
